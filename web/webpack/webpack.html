<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.37" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://soft-vault.com/web/webpack/webpack.html"><meta property="og:site_name" content="Night.Soul"><meta property="og:title" content="🪤 Webpack"><meta property="og:description" content="高级篇 7.9 基础篇 1. Why? 为什么需要 webpack 问题 作用于问题 GRUNT IIFE 代码拆分问题 - nodejs 提供 JavaScript 运行环境 模块化 COMMION JS -> module.exports = {} -> require 上述代码是 nodejs 代码,无法在浏览器运行 如何在浏览器上使用? ECM..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-03-02T15:02:26.000Z"><meta property="article:author" content="Night.Soul"><meta property="article:tag" content="Webpack"><meta property="article:modified_time" content="2024-03-02T15:02:26.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"🪤 Webpack","image":[""],"dateModified":"2024-03-02T15:02:26.000Z","author":[{"@type":"Person","name":"Night.Soul","url":"https://github.com/NightSquirrl"}]}</script><title>🪤 Webpack | Night.Soul</title><meta name="description" content="高级篇 7.9 基础篇 1. Why? 为什么需要 webpack 问题 作用于问题 GRUNT IIFE 代码拆分问题 - nodejs 提供 JavaScript 运行环境 模块化 COMMION JS -> module.exports = {} -> require 上述代码是 nodejs 代码,无法在浏览器运行 如何在浏览器上使用? ECM...">
    <link rel="preload" href="/assets/style-L2xOcyZ2.css" as="style"><link rel="stylesheet" href="/assets/style-L2xOcyZ2.css">
    <link rel="modulepreload" href="/assets/app-jzX7c5DY.js"><link rel="modulepreload" href="/assets/webpack.html-Dgy6zjYT.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-B5Nndg1W.js" as="script"><link rel="prefetch" href="/assets/Javascript.html-CPU3RuiV.js" as="script"><link rel="prefetch" href="/assets/Vue.html-BFMcMZbB.js" as="script"><link rel="prefetch" href="/assets/react.html-g8lNbt91.js" as="script"><link rel="prefetch" href="/assets/typescript.html-_rB9C9WZ.js" as="script"><link rel="prefetch" href="/assets/basic-use-of-drawing-bed.html-zCHSYhSj.js" as="script"><link rel="prefetch" href="/assets/serverInitializationUsage.html-fWDMjTSl.js" as="script"><link rel="prefetch" href="/assets/1-IntroductionToFundamentals.html-W4WrkME3.js" as="script"><link rel="prefetch" href="/assets/10-String.html-C6kdoikw.js" as="script"><link rel="prefetch" href="/assets/11-SetArrayList.html-BCH15ki2.js" as="script"><link rel="prefetch" href="/assets/12-ObjectOrientedAdvancement(StaticInheritance).html-bvnEsP-H.js" as="script"><link rel="prefetch" href="/assets/13-AdvancedObjectOriented(Polymorphic).html-CKNouqPR.js" as="script"><link rel="prefetch" href="/assets/14-AdvancedObjectOriented(Interface).html-DqA3QNHM.js" as="script"><link rel="prefetch" href="/assets/15-ObjectOriented(ComprehensiveExercise1).html-e2Fnbkyd.js" as="script"><link rel="prefetch" href="/assets/16-ObjectOriented(ComprehensiveExercise2).html-DOo02Z_r.js" as="script"><link rel="prefetch" href="/assets/17-CommonAPIs.html-HuybVYsU.js" as="script"><link rel="prefetch" href="/assets/18-RegularExpressions.html-4w9wAAOd.js" as="script"><link rel="prefetch" href="/assets/19-CommonAPIs(TimePackaging).html-D5z2lNQz.js" as="script"><link rel="prefetch" href="/assets/2-JavaBasicGrammar.html-C_ftORUt.js" as="script"><link rel="prefetch" href="/assets/20-Algorithm.html-0b3cdN1x.js" as="script"><link rel="prefetch" href="/assets/21-Set01.html-BQQCncfO.js" as="script"><link rel="prefetch" href="/assets/22-Set02.html-DTRp8vMi.js" as="script"><link rel="prefetch" href="/assets/23-Set03.html-D5NIaDv2.js" as="script"><link rel="prefetch" href="/assets/24-ThirdStageSynthesis(LandlordGame).html-CWrpIsIl.js" as="script"><link rel="prefetch" href="/assets/25-StreamFlowAndMethodReferences.html-B2qlwoXF.js" as="script"><link rel="prefetch" href="/assets/26- IOStream(ByteStream_CharacterStream).html-cuG0y-2C.js" as="script"><link rel="prefetch" href="/assets/27-IOStream(OtherStreams).html-dF39fEZa.js" as="script"><link rel="prefetch" href="/assets/28-MultiThreading01.html-Ck_4W5uD.js" as="script"><link rel="prefetch" href="/assets/29-MultiThreading02.html-BLodAITM.js" as="script"><link rel="prefetch" href="/assets/3-Operator.html-DeUCUgJm.js" as="script"><link rel="prefetch" href="/assets/30-NetworkProgramming.html-GyUH3Abi.js" as="script"><link rel="prefetch" href="/assets/31-ReflectionDynamicProxy.html-cr-xngIT.js" as="script"><link rel="prefetch" href="/assets/32-IO(Exception_File_ComprehensiveCase).html-CT4IHjSy.js" as="script"><link rel="prefetch" href="/assets/4-FlowControlStatement.html-BnMgLjdB.js" as="script"><link rel="prefetch" href="/assets/5-Array.html-BVHFaDwb.js" as="script"><link rel="prefetch" href="/assets/6-Function.html-DfjzYrXb.js" as="script"><link rel="prefetch" href="/assets/7-Phase-1-ComprehensiveExercise.html-xkQuKu7g.js" as="script"><link rel="prefetch" href="/assets/8-ObjectOriented.html-DgrncCef.js" as="script"><link rel="prefetch" href="/assets/9-Phase-2-ObjectOrientedPractice.html-CwrM17-A.js" as="script"><link rel="prefetch" href="/assets/JavaSummarize.html-CMh2Knru.js" as="script"><link rel="prefetch" href="/assets/1-Maven.html-CyqJKgpl.js" as="script"><link rel="prefetch" href="/assets/10-mybatis-plus.html-D3H5H9r7.js" as="script"><link rel="prefetch" href="/assets/11-redis.html-C8In_dPx.js" as="script"><link rel="prefetch" href="/assets/12-Spring.html-Be1fdqxm.js" as="script"><link rel="prefetch" href="/assets/2-SpringBootBasis.html-CgRCz9A8.js" as="script"><link rel="prefetch" href="/assets/3-SpringBootWebRequestResponse.html-BubOMOIH.js" as="script"><link rel="prefetch" href="/assets/4-MybatisIntroduction.html-DT0l2mT5.js" as="script"><link rel="prefetch" href="/assets/5-MybatisUse.html-fXXhvn2Y.js" as="script"><link rel="prefetch" href="/assets/6-JWT.html-BV-_SruT.js" as="script"><link rel="prefetch" href="/assets/7-AOP.html-Cr7GHvFh.js" as="script"><link rel="prefetch" href="/assets/8-Swagger.html-Cq86NdJ0.js" as="script"><link rel="prefetch" href="/assets/9-cross-domain.html-DvV7Ivik.js" as="script"><link rel="prefetch" href="/assets/Collection.html-C8XaN4lo.js" as="script"><link rel="prefetch" href="/assets/index.html-CdV-3M9Q.js" as="script"><link rel="prefetch" href="/assets/index.html-DgNMapSV.js" as="script"><link rel="prefetch" href="/assets/collect.html-B2LSFu00.js" as="script"><link rel="prefetch" href="/assets/commonCommands.html-D27xLF7v.js" as="script"><link rel="prefetch" href="/assets/1-install.html-Du3As5FL.js" as="script"><link rel="prefetch" href="/assets/2-database-concept.html-C_Dvh_HD.js" as="script"><link rel="prefetch" href="/assets/3-SQL-statement.html-BYCGE9PE.js" as="script"><link rel="prefetch" href="/assets/4-advanced-database.html-j9bw1Exc.js" as="script"><link rel="prefetch" href="/assets/nodeVersionControl.html-CJhprndN.js" as="script"><link rel="prefetch" href="/assets/terminal.html-CE8kWwAl.js" as="script"><link rel="prefetch" href="/assets/index.html-CZFAIGlc.js" as="script"><link rel="prefetch" href="/assets/index.html-CY1q-cVd.js" as="script"><link rel="prefetch" href="/assets/index.html-CZrQBmIm.js" as="script"><link rel="prefetch" href="/assets/Arguments.html-oXPzFgNW.js" as="script"><link rel="prefetch" href="/assets/apply-bind-call.html-B-yCoy_B.js" as="script"><link rel="prefetch" href="/assets/index.html-CarEzAZB.js" as="script"><link rel="prefetch" href="/assets/Array.html-CL1sPW_v.js" as="script"><link rel="prefetch" href="/assets/WaterfallFlow.html-BOKYs2cN.js" as="script"><link rel="prefetch" href="/assets/antiVibrationThrottling.html-DEzL7dKl.js" as="script"><link rel="prefetch" href="/assets/designPattern.html-BMq8Gbje.js" as="script"><link rel="prefetch" href="/assets/index.html-DTa6OOlw.js" as="script"><link rel="prefetch" href="/assets/npm-packages.html-BkyczlKS.js" as="script"><link rel="prefetch" href="/assets/rollup.html-C7s3HBmQ.js" as="script"><link rel="prefetch" href="/assets/grid.html-DDIsSQu9.js" as="script"><link rel="prefetch" href="/assets/1-projectEngineeringStructure.html-Bf9TjHMY.js" as="script"><link rel="prefetch" href="/assets/2-components.html-f1lHPt1h.js" as="script"><link rel="prefetch" href="/assets/3-customComponents.html-BL0xIYw_.js" as="script"><link rel="prefetch" href="/assets/4-stateManagement.html-CsJQobOy.js" as="script"><link rel="prefetch" href="/assets/5-router.html-C8fxkvKG.js" as="script"><link rel="prefetch" href="/assets/6-pageAnimation.html-B800yt17.js" as="script"><link rel="prefetch" href="/assets/7-lifeCycle.html-BZ7FS2Bw.js" as="script"><link rel="prefetch" href="/assets/8-networkRequest.html-D-BriONL.js" as="script"><link rel="prefetch" href="/assets/9-dataPersistence.html-C2n1-oJH.js" as="script"><link rel="prefetch" href="/assets/1-vue-router.html-JoYvxucs.js" as="script"><link rel="prefetch" href="/assets/2-vue-vuex-pinia.html-CnPFzUC5.js" as="script"><link rel="prefetch" href="/assets/3-communication-mode.html-sS7TYJ6l.js" as="script"><link rel="prefetch" href="/assets/4-vue-jsx.html-T3DWGkCL.js" as="script"><link rel="prefetch" href="/assets/XMLHttpRequest.html-DdAkwIAl.js" as="script"><link rel="prefetch" href="/assets/websocket.html-D-5-OCnT.js" as="script"><link rel="prefetch" href="/assets/Gulp.html-BGvMr9GS.js" as="script"><link rel="prefetch" href="/assets/UniversalJs.html-DEqmoYNx.js" as="script"><link rel="prefetch" href="/assets/frontend-performance-optimization.html-YmPS-BL3.js" as="script"><link rel="prefetch" href="/assets/general-SEO-optimization-plan.html-BH2cpuys.js" as="script"><link rel="prefetch" href="/assets/axios-shortcut.html-CrCUAIjN.js" as="script"><link rel="prefetch" href="/assets/regular-expression.html-D7X7_jre.js" as="script"><link rel="prefetch" href="/assets/cookie.html-fWliofuG.js" as="script"><link rel="prefetch" href="/assets/1-quick-get-start.html-DZEHj2Nh.js" as="script"><link rel="prefetch" href="/assets/2-shadow.html-D3uhKDDS.js" as="script"><link rel="prefetch" href="/assets/1-basic-concepts.html-DV8Enw8A.js" as="script"><link rel="prefetch" href="/assets/3-advanced-expand.html-Cq0G95XX.js" as="script"><link rel="prefetch" href="/assets/1-quick-get-start.html-BGwoN9Bd.js" as="script"><link rel="prefetch" href="/assets/algorithm.html-B5mQU3ox.js" as="script"><link rel="prefetch" href="/assets/web-learn.html-DRlnUJtG.js" as="script"><link rel="prefetch" href="/assets/web-worker.html-Bm1CLke-.js" as="script"><link rel="prefetch" href="/assets/Webpack_React.html-dRzQrfbw.js" as="script"><link rel="prefetch" href="/assets/index.html-5c2RiPaI.js" as="script"><link rel="prefetch" href="/assets/ant-unocss-ts-vite-react.html-Bq2WrYT2.js" as="script"><link rel="prefetch" href="/assets/404.html-CUqixs9-.js" as="script"><link rel="prefetch" href="/assets/index.html-K2yuU0Oz.js" as="script"><link rel="prefetch" href="/assets/index.html-B2htEv2k.js" as="script"><link rel="prefetch" href="/assets/index.html-BtAKN6pH.js" as="script"><link rel="prefetch" href="/assets/index.html-CWzV_z-y.js" as="script"><link rel="prefetch" href="/assets/index.html-Df5viEav.js" as="script"><link rel="prefetch" href="/assets/index.html-CGErj1tv.js" as="script"><link rel="prefetch" href="/assets/index.html-D2U3vn23.js" as="script"><link rel="prefetch" href="/assets/index.html-CdfbFedA.js" as="script"><link rel="prefetch" href="/assets/index.html-B7_Q_UIj.js" as="script"><link rel="prefetch" href="/assets/index.html-C0g-BeGY.js" as="script"><link rel="prefetch" href="/assets/index.html-BFrOmlSO.js" as="script"><link rel="prefetch" href="/assets/index.html-DmESZ_T8.js" as="script"><link rel="prefetch" href="/assets/index.html-Haa23vIu.js" as="script"><link rel="prefetch" href="/assets/index.html-C_ebE2O4.js" as="script"><link rel="prefetch" href="/assets/index.html-CkgOiUue.js" as="script"><link rel="prefetch" href="/assets/index.html-CmfquO4u.js" as="script"><link rel="prefetch" href="/assets/index.html-C-LWd00b.js" as="script"><link rel="prefetch" href="/assets/index.html-CTmpBsbt.js" as="script"><link rel="prefetch" href="/assets/index.html-DBaLlYEI.js" as="script"><link rel="prefetch" href="/assets/index.html-15fXpozU.js" as="script"><link rel="prefetch" href="/assets/index.html-BqE5KLIv.js" as="script"><link rel="prefetch" href="/assets/index.html-DxW56G-m.js" as="script"><link rel="prefetch" href="/assets/index.html-Cu1fltEy.js" as="script"><link rel="prefetch" href="/assets/index.html-B7ohcpqq.js" as="script"><link rel="prefetch" href="/assets/index.html-GdL_iNpQ.js" as="script"><link rel="prefetch" href="/assets/index.html-CXHpwXyS.js" as="script"><link rel="prefetch" href="/assets/index.html-BfTe9RlO.js" as="script"><link rel="prefetch" href="/assets/index.html-7GfgDiLi.js" as="script"><link rel="prefetch" href="/assets/index.html-BIh5zmY0.js" as="script"><link rel="prefetch" href="/assets/index.html-DGS0MqZn.js" as="script"><link rel="prefetch" href="/assets/index.html-CiSkbp3t.js" as="script"><link rel="prefetch" href="/assets/index.html-Dc6uG3dX.js" as="script"><link rel="prefetch" href="/assets/index.html-BhBcvha3.js" as="script"><link rel="prefetch" href="/assets/index.html-B4bdbZQ0.js" as="script"><link rel="prefetch" href="/assets/index.html-CYL8cOk4.js" as="script"><link rel="prefetch" href="/assets/index.html-Mxe8Co8H.js" as="script"><link rel="prefetch" href="/assets/index.html-DI0Dcpgw.js" as="script"><link rel="prefetch" href="/assets/index.html-CBGB-es6.js" as="script"><link rel="prefetch" href="/assets/index.html-Djet4x0A.js" as="script"><link rel="prefetch" href="/assets/index.html-DMM8iACR.js" as="script"><link rel="prefetch" href="/assets/index.html-DWJQNdHi.js" as="script"><link rel="prefetch" href="/assets/index.html-BReAgTcA.js" as="script"><link rel="prefetch" href="/assets/index.html-BEjUWgv6.js" as="script"><link rel="prefetch" href="/assets/index.html-B1ImENeb.js" as="script"><link rel="prefetch" href="/assets/index.html-DAKTR_Mq.js" as="script"><link rel="prefetch" href="/assets/index.html-Ct015CSR.js" as="script"><link rel="prefetch" href="/assets/index.html-DMFQYLEi.js" as="script"><link rel="prefetch" href="/assets/index.html-D0SYP72K.js" as="script"><link rel="prefetch" href="/assets/index.html-Bxf7ygFV.js" as="script"><link rel="prefetch" href="/assets/index.html-CuBLNI61.js" as="script"><link rel="prefetch" href="/assets/index.html-CVRsHd4m.js" as="script"><link rel="prefetch" href="/assets/index.html-Do6Qu0VK.js" as="script"><link rel="prefetch" href="/assets/index.html-CENi6FGL.js" as="script"><link rel="prefetch" href="/assets/index.html-BQ3fXocS.js" as="script"><link rel="prefetch" href="/assets/index.html-C8hwAdIa.js" as="script"><link rel="prefetch" href="/assets/index.html-DuUl6yKz.js" as="script"><link rel="prefetch" href="/assets/index.html-CZdEARyd.js" as="script"><link rel="prefetch" href="/assets/index.html-BItXQj-j.js" as="script"><link rel="prefetch" href="/assets/index.html-DS9pFLNk.js" as="script"><link rel="prefetch" href="/assets/index.html-Bl9O3fsu.js" as="script"><link rel="prefetch" href="/assets/index.html-DpeZu3qk.js" as="script"><link rel="prefetch" href="/assets/index.html-0dS01sr4.js" as="script"><link rel="prefetch" href="/assets/index.html-C8ALuInB.js" as="script"><link rel="prefetch" href="/assets/index.html-D9P-9HuP.js" as="script"><link rel="prefetch" href="/assets/index.html-lhBECJ6C.js" as="script"><link rel="prefetch" href="/assets/index.html-C6SYLGb-.js" as="script"><link rel="prefetch" href="/assets/index.html-puxPGhU_.js" as="script"><link rel="prefetch" href="/assets/index.html-BlMYNqIX.js" as="script"><link rel="prefetch" href="/assets/index.html-C4AVYk93.js" as="script"><link rel="prefetch" href="/assets/index.html-B1b2aWRA.js" as="script"><link rel="prefetch" href="/assets/index.html-aL1Ry-3j.js" as="script"><link rel="prefetch" href="/assets/index.html-YddYUS_c.js" as="script"><link rel="prefetch" href="/assets/index.html-D691tnrk.js" as="script"><link rel="prefetch" href="/assets/index.html-CkM2FDIN.js" as="script"><link rel="prefetch" href="/assets/index.html-BZZZGvWV.js" as="script"><link rel="prefetch" href="/assets/index.html-D0HMuzly.js" as="script"><link rel="prefetch" href="/assets/index.html-B8AcYAsK.js" as="script"><link rel="prefetch" href="/assets/index.html-M66fCDHR.js" as="script"><link rel="prefetch" href="/assets/index.html-NVFzcjOq.js" as="script"><link rel="prefetch" href="/assets/index.html-MHq5x4CU.js" as="script"><link rel="prefetch" href="/assets/index.html-D3ooWbSB.js" as="script"><link rel="prefetch" href="/assets/index.html-B4bdbZQ0.js" as="script"><link rel="prefetch" href="/assets/index.html-BRfuWjOS.js" as="script"><link rel="prefetch" href="/assets/index.html-DJiJzX7N.js" as="script"><link rel="prefetch" href="/assets/index.html-Cy7I-S2Y.js" as="script"><link rel="prefetch" href="/assets/index.html-DpvLsWo9.js" as="script"><link rel="prefetch" href="/assets/index.html-DiRQh6gf.js" as="script"><link rel="prefetch" href="/assets/index.html-CMTLEfeS.js" as="script"><link rel="prefetch" href="/assets/index.html-qi8fWPv-.js" as="script"><link rel="prefetch" href="/assets/index.html-B8_kqpVi.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-SzV8tJDW.js" as="script"><link rel="prefetch" href="/assets/giscus--_FS5kYt.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="https://img.picgo.net/2024/02/05/logocffd7abf34977d0b.png" alt><!----><span class="vp-site-name hide-in-pad">Night.Soul</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/" aria-label="回到主页"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>回到主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link active" href="/web/" aria-label="前端"><span class="font-icon icon fa-fw fa-sm fas fa-dragon" style=""></span>前端<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/rear-end/" aria-label="后端"><span class="font-icon icon fa-fw fa-sm fas fa-book-skull" style=""></span>后端<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/server/" aria-label="运维"><span class="font-icon icon fa-fw fa-sm fas fa-chess-board" style=""></span>运维<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="web"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>web</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Vue</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a class="route-link nav-link" href="/web/Vue文档/" aria-label="Vue 文档"><!---->Vue 文档<!----></a></li><li class="dropdown-subitem"><a class="route-link nav-link" href="/web/Vue/vue-vuex-pinia.html" aria-label="Vuex"><!---->Vuex<!----></a></li><li class="dropdown-subitem"><a class="route-link nav-link" href="/web/Vue/vue-router.html" aria-label="vue-router"><!---->vue-router<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>React</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a class="route-link nav-link" href="/web/react/code-init/ant-unocss-ts-vite-react.html" aria-label="项目初始化"><!---->项目初始化<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>PDF</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a class="route-link nav-link" href="/web/PDF/pdfjs/" aria-label="PDFJS"><!---->PDFJS<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>二维码 项目</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a class="route-link nav-link" href="/web/QrCode/" aria-label="项目手册"><!---->项目手册<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ThreeJS</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a class="route-link nav-link" href="/web/threeJs/1-quick-get-start.html" aria-label="快速入门"><!---->快速入门<!----></a></li><li class="dropdown-subitem"><a class="route-link nav-link" href="/web/threeJs/2-shadow.html" aria-label="光影"><!---->光影<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>uni-app</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a class="route-link nav-link" href="/web/uni-app/1-quick-get-start.html" aria-label="快速入门"><!---->快速入门<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>webpack</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a class="route-link nav-link active" href="/web/webpack/" aria-label="快速入门"><!---->快速入门<!----></a></li><li class="dropdown-subitem"><a class="route-link nav-link" href="/web/webpack/Webpack_React.html" aria-label="手动搭建 React 脚手架"><!---->手动搭建 React 脚手架<!----></a></li></ul></li><li class="dropdown-item"><a class="route-link nav-link" href="/web/common-method/Array.html" aria-label="常用方法"><!---->常用方法<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/web/FFmpeg/" aria-label="FFmpeg"><!---->FFmpeg<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/web/component-packaging/rollup.html" aria-label="Rollup组件封装"><!---->Rollup组件封装<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/web/Echarts/" aria-label="Echart"><!---->Echart<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/web/network-request/XMLHttpRequest.html" aria-label="网络请求"><!---->网络请求<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/web/css/grid.html" aria-label="CSS"><!---->CSS<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/web/GoogleDrive/" aria-label="Google Drive"><!---->Google Drive<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="后端"><span class="title"><!---->后端</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/rear-end/Java/1-IntroductionToFundamentals.html" aria-label="Java"><!---->Java<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/rear-end/JavaWeb/1-Maven.html" aria-label="Maven"><!---->Maven<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/rear-end/JavaWeb/2-SpringBootBasis.html" aria-label="SpringBoot"><!---->SpringBoot<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/rear-end/JavaWeb/4-MybatisIntroduction.html" aria-label="Mybatis"><!---->Mybatis<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/rear-end/JavaWeb/10-mybatis-plus.html" aria-label="Mybatis-Plus"><!---->Mybatis-Plus<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/rear-end/JavaWeb/11-redis.html" aria-label="Redis"><!---->Redis<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="运维"><span class="title"><!---->运维</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a class="route-link nav-link" href="/server/NGINX/" aria-label="NGINX"><!---->NGINX<!----></a></li><li class="dropdown-item"><a class="route-link nav-link" href="/server/Docker/" aria-label="Docker"><!---->Docker<!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>MySQL</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a class="route-link nav-link" href="/server/mysql/1-install.html" aria-label="安装"><!---->安装<!----></a></li></ul></li><li class="dropdown-item"><a class="route-link nav-link" href="/server/window/terminal.html" aria-label="Window 终端与Linux"><!---->Window 终端与Linux<!----></a></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/NightSquirrl/what-tools-blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/" aria-label="回到主页"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>回到主页<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-dragon" style=""></span><span class="vp-sidebar-title">前端</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Common</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Component Packaging</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Css</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Echarts</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">FFmpeg</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Google Drive</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Harmony</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Javascript</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Learn Vue</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Network Request</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Optimize</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Package</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">PDF</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Qr Code</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">React</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Storage</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Three Js</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Typescript</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Uni App</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Web Learn</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Webpack</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/web/webpack/Webpack_React.html" aria-label="🧐 Webpack + React"><!---->🧐 Webpack + React<!----></a></li><li><a class="route-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/web/webpack/webpack.html" aria-label="🪤 Webpack"><!---->🪤 Webpack<!----></a></li></ul></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book-skull" style=""></span><span class="vp-sidebar-title">后端</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-chess-board" style=""></span><span class="vp-sidebar-title">运维</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->🪤 Webpack</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/NightSquirrl" target="_blank" rel="noopener noreferrer">Night.Soul</a></span><span property="author" content="Night.Soul"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-11-04T10:35:06.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 24 分钟</span><meta property="timeRequired" content="PT24M"></span><!----><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag4 clickable" role="navigation">Webpack</span><!--]--><meta property="keywords" content="Webpack"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-why-为什么需要-webpack">1. Why? 为什么需要 webpack</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-安装-webpack">2. 安装 webpack</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#简单的使用">简单的使用</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-基本自定义-webpack-配置">3. 基本自定义 webpack 配置</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-1自动引入资源-htmlwebpackplugin">3.1自动引入资源 - HtmlWebpackPlugin</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-2搭建开发环境">3.2搭建开发环境</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-resource资源">4. Resource资源</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-管理资源">5. 管理资源</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-1-css-模块">5.1 css 模块</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-2-less-loader">5.2 less loader</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-3-抽离和压缩-css">5.3 抽离和压缩 css</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-4-加载-fonts-字体">5.4 加载 fonts 字体</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-5-加载数据-xml-csv">5.5 加载数据 xml csv</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-6-自定义-json-模块-parser">5.6 自定义 JSON 模块 parser</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_6-babel-loader的使用">6. babel-loader的使用</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_7-代码分离">7. 代码分离</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-1修改-entry">7.1修改 entry</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-2-防止重复打包">7.2 防止重复打包</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-3-动态导入">7.3 动态导入</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-4-懒加载">7.4  懒加载</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-5-预获取预加载">7.5 预获取预加载</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_8-缓存">8.  缓存</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-1-修改输出文件的文件名">8.1 修改输出文件的文件名</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-2-缓存第三方库">8.2 缓存第三方库</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-2-汇总js文件">8.2 汇总js文件</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_9-拆分开发环境和生成环境">9.拆分开发环境和生成环境</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-1-公共路径">9.1  公共路径</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-2-环境变量">9.2 环境变量</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-3-压缩代码">9.3 压缩代码</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-4-拆分配置文件">9.4 拆分配置文件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-5-npm命令配置">9.5 npm命令配置</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-6-提取公共配置">9.6  提取公共配置</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-source-map">1. source map</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-devserver">2. devServer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-模块热替换与热加载">3. 模块热替换与热加载</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-eslint">4. eslint</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-1借助-webpack">4.1借助 webpack</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-git-hooks与husky">5. git-hooks与husky</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-1-使用-husky-完成以上功能">5.1 使用 husky 完成以上功能</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_6-模块解析-resolve">6. 模块解析（resolve）</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-1-webpack中的模块路径解析规则">6.1 webpack中的模块路径解析规则</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-2-外部扩展">6.2 外部扩展</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-3-依赖图">6.3 依赖图</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_7-扩展功能">7. 扩展功能</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-1-postcss和css模块">7.1 PostCSS和CSS模块</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-2-web-worker">7.2 Web Worker</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-3-typescript">7.3 TypeScript</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-4-多页面应用">7.4 多页面应用</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-5-try-shaking">7.5 Try Shaking</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-6-渐进式网络应用程序-pwa">7.6 渐进式网络应用程序 PWA</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-7-shimming-预置依赖">7.7 shimming 预置依赖</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-8-加载polyfills">7.8 加载polyfills</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-9-构建library">7.9 构建Library</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-10-模块联邦-module-federation">7.10 模块联邦（Module Federation）</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-11-通用构建优化">7.11 通用构建优化</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-12-开发环境提升构建性能">7.12 开发环境提升构建性能</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><blockquote><p>高级篇 7.9</p></blockquote><h1 id="基础篇" tabindex="-1"><a class="header-anchor" href="#基础篇"><span>基础篇</span></a></h1><h2 id="_1-why-为什么需要-webpack" tabindex="-1"><a class="header-anchor" href="#_1-why-为什么需要-webpack"><span>1. Why? 为什么需要 webpack</span></a></h2><blockquote><p>问题</p></blockquote><ol><li>作用于问题 GRUNT IIFE</li></ol><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 立即调用函数</span>
<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 在外部调用</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token comment">// 程序报错,无法访问到</span>

<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token comment">// 可以访问到</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>代码拆分问题 - nodejs 提供 JavaScript 运行环境 模块化 COMMION JS -&gt; module.exports = {} -&gt; require</li></ol><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 新建文件 math.js</span>
<span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x <span class="token operator">+</span> y</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    add
<span class="token punctuation">}</span>

<span class="token comment">// 引用</span>
<span class="token keyword">const</span>  math <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./math&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上述代码是 nodejs 代码,无法在浏览器运行</p><blockquote><p>如何在浏览器上使用?</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 新建文件 add.js</span>
<span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x <span class="token operator">+</span> y</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 第一个参数,所写的,模块依赖的其他模块</span>
<span class="token comment">// 第二个参数,回调函数</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> add
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 在 HTML 中使用</span>
<span class="token comment">// 使用 require.js</span>
<span class="token comment">// 新建入口文件 mian.js</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;./add.js&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">add</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>script 
src<span class="token operator">=</span><span class="token string">&quot;https://cdn.bootcdn.net/ajax/libs/require.js/2.3.6/require.js&quot;</span> 
    data<span class="token operator">-</span>main<span class="token operator">=</span><span class="token string">&quot;&quot;</span>
    <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>ECMAScript module</li></ol><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 新建文件 add.js</span>
<span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x <span class="token operator">+</span> y</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> add

<span class="token comment">// 使用</span>
<span class="token comment">// 必须添加 type</span>
<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;module&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> add <span class="token keyword">from</span> <span class="token string">&quot;./add.js&quot;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token comment">// 当访问页面的时候 要使用 http server</span>

<span class="token comment">// 使用临时 server</span>

npx http<span class="token operator">-</span>server

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-安装-webpack" tabindex="-1"><a class="header-anchor" href="#_2-安装-webpack"><span>2. 安装 webpack</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 全局安装</span>
<span class="token function">npm</span> i <span class="token parameter variable">-g</span> webpack webpack-cli

webpack <span class="token parameter variable">-v</span>
<span class="token comment"># 本地项目 安装</span>
<span class="token function">npm</span> init <span class="token parameter variable">-y</span>
<span class="token function">npm</span> i webpack webpack-cli
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="简单的使用" tabindex="-1"><a class="header-anchor" href="#简单的使用"><span>简单的使用</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>webpack <span class="token comment">#开始打包</span>
webpack <span class="token parameter variable">--stats</span> detailed <span class="token comment"># 展示打包信息</span>
npx webpack  <span class="token comment"># 项目内命令</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-基本自定义-webpack-配置" tabindex="-1"><a class="header-anchor" href="#_3-基本自定义-webpack-配置"><span>3. 基本自定义 webpack 配置</span></a></h2><blockquote><p>命令行的方式</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>npx webpack <span class="token parameter variable">--entry</span> ./src/index.js <span class="token parameter variable">--output</span> ./dist/main.js <span class="token parameter variable">--mode</span> production
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>配置文件方式</p></blockquote><p>新建文件 webpack.config.js</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&#39;./src/js/index.js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;main.js&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-1自动引入资源-htmlwebpackplugin" tabindex="-1"><a class="header-anchor" href="#_3-1自动引入资源-htmlwebpackplugin"><span>3.1自动引入资源 - HtmlWebpackPlugin</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i html-webpack-plugin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>webpack.config.js</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;html-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token literal-property property">plugin</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.html&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;index.html&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">inject</span><span class="token operator">:</span> <span class="token string">&#39;body&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>每次打包清空之前 dist 目录</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">output</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token literal-property property">clean</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2搭建开发环境" tabindex="-1"><a class="header-anchor" href="#_3-2搭建开发环境"><span>3.2搭建开发环境</span></a></h3><h4 id="_3-2-1-sourece-map" tabindex="-1"><a class="header-anchor" href="#_3-2-1-sourece-map"><span>3.2.1 sourece map</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">devtool</span><span class="token operator">:</span><span class="token string">&quot;inline-source-map&quot;</span> <span class="token comment">//bundle.js文件正常的显示代码,并且报错的位置正常的显示</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_3-2-2-watch-监听编译-热编译" tabindex="-1"><a class="header-anchor" href="#_3-2-2-watch-监听编译-热编译"><span>3.2.2 watch 监听编译 热编译</span></a></h4><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>npx webpack <span class="token parameter variable">--watch</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_3-2-3-webpack-dev-server-热更新" tabindex="-1"><a class="header-anchor" href="#_3-2-3-webpack-dev-server-热更新"><span>3.2.3 webpack dev server 热更新</span></a></h4><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i webpack-dev-server <span class="token parameter variable">-D</span> <span class="token comment"># 开发依赖,只有 development 模式才会使用到的依赖</span>
npx webpack-dev-server <span class="token parameter variable">--open</span> <span class="token comment"># 自动打开页面</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">devServer</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span><span class="token operator">:</span><span class="token string">&quot;./dist&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-resource资源" tabindex="-1"><a class="header-anchor" href="#_4-resource资源"><span>4. Resource资源</span></a></h2><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&quot;asset/resource&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">genterator</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token string">&quot;images/test.png&quot;</span> <span class="token comment">// 优先级会更高</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.svg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&quot;asset/inline&quot;</span><span class="token punctuation">,</span> <span class="token comment">// base64 格式</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.txt$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&quot;asset/source&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 读取文本内容,原始资源</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jpg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&quot;asset&quot;</span><span class="token punctuation">,</span> <span class="token comment">// asset/resource 与asset/inline 切换 小于 8k使用 base64</span>
      <span class="token literal-property property">parser</span><span class="token operator">:</span><span class="token punctuation">{</span>
          <span class="token literal-property property">dataUrlCondition</span><span class="token operator">:</span><span class="token punctuation">{</span>
						<span class="token literal-property property">maxSize</span><span class="token operator">:</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span>  <span class="token comment">// 4M  临界值</span>
          <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token literal-property property">output</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">assetModuleFilename</span><span class="token operator">:</span><span class="token string">&quot;images/[contenthash][ext]&quot;</span><span class="token comment">// 指定图片资源的存放路径</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-管理资源" tabindex="-1"><a class="header-anchor" href="#_5-管理资源"><span>5. 管理资源</span></a></h2><blockquote><p>webpack只能解析JS、JSON文件，通过loader可以实现在js上加载css等其他文件</p></blockquote><h3 id="_5-1-css-模块" tabindex="-1"><a class="header-anchor" href="#_5-1-css-模块"><span>5.1 css 模块</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i css-loader <span class="token parameter variable">-D</span> <span class="token comment"># 解析 css 文件</span>
<span class="token function">npm</span> i style-loader <span class="token parameter variable">-D</span> <span class="token comment"># 实现在页面写入 css </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token string">&quot;/\.css$/&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">use</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">]</span> <span class="token comment">// 执行的循序,从后往前</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-2-less-loader" tabindex="-1"><a class="header-anchor" href="#_5-2-less-loader"><span>5.2 less loader</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i less-loader <span class="token function">less</span> <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token string">&quot;/\.(css|less)$/&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">use</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;less-loader&quot;</span><span class="token punctuation">]</span> <span class="token comment">// 执行的循序,从后往前</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3-抽离和压缩-css" tabindex="-1"><a class="header-anchor" href="#_5-3-抽离和压缩-css"><span>5.3 抽离和压缩 css</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i mini-css-extract-plugin <span class="token parameter variable">-D</span>
<span class="token function">npm</span> i css-minimizer-webpack-plugin <span class="token parameter variable">-D</span> <span class="token comment"># 压缩 css</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;min-css-extract-plugin&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> CssMinimizerWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;css-minimizer-webpack-plugin&quot;</span><span class="token punctuation">)</span>

<span class="token literal-property property">plugin</span><span class="token operator">:</span><span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  	<span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token string">&quot;style/[contenthash].css&quot;</span> <span class="token comment">// 指定目录</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token string">&quot;/\.(css|less)$/&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">use</span><span class="token operator">:</span><span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span><span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;less-loader&quot;</span><span class="token punctuation">]</span> <span class="token comment">// MiniCssExtractPlugin 通过 link 引入 css</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">minimizer</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CssMinimizerWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-4-加载-fonts-字体" tabindex="-1"><a class="header-anchor" href="#_5-4-加载-fonts-字体"><span>5.4 加载 fonts 字体</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token string">&quot;/\.(woff|woff2|eot|ttf|otf)$/&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;asset/resource&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-5-加载数据-xml-csv" tabindex="-1"><a class="header-anchor" href="#_5-5-加载数据-xml-csv"><span>5.5 加载数据 xml csv</span></a></h3><blockquote><p>xml会被解析为对象,csv 会被解析为数组</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i csv-loader xml-loader <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token string">&quot;/\.(csv|tsv)$/&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">use</span><span class="token operator">:</span><span class="token string">&quot;csv-loader&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token string">&quot;/\.xml$/&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">use</span><span class="token operator">:</span><span class="token string">&quot;xml-loader&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-6-自定义-json-模块-parser" tabindex="-1"><a class="header-anchor" href="#_5-6-自定义-json-模块-parser"><span>5.6 自定义 JSON 模块 parser</span></a></h3><blockquote><p>yaml taml json5</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i tomal yaml json5 <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> toml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;toml&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> yaml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;yaml&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> json5 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;json5&quot;</span><span class="token punctuation">)</span>

<span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token string">&quot;/\.toml$/&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&quot;json&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">parser</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token literal-property property">parse</span><span class="token operator">:</span>toml<span class="token punctuation">.</span>parser
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token string">&quot;/\.yarml$/&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&quot;json&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">parser</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token literal-property property">parse</span><span class="token operator">:</span>yaml<span class="token punctuation">.</span>parser
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token string">&quot;/\.json5$/&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&quot;json&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">parser</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token literal-property property">parse</span><span class="token operator">:</span>json5<span class="token punctuation">.</span>parser
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-babel-loader的使用" tabindex="-1"><a class="header-anchor" href="#_6-babel-loader的使用"><span>6. babel-loader的使用</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i babel-loader @babel/core @babel/preset-env <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> toml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;toml&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> yaml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;yaml&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> json5 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;json5&quot;</span><span class="token punctuation">)</span>

<span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token string">&quot;/\.js$/&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">exclude</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  		<span class="token literal-property property">use</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">options</span><span class="token operator">:</span><span class="token punctuation">{</span>
          <span class="token literal-property property">presets</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>regeneratorRuntime 是 webpack 打包生成的全局辅助函数,由babel生成,用于兼容 await/async</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i @babel/runtime <span class="token parameter variable">-D</span>
<span class="token function">npm</span> i @babel/plugin-transfrom-runtime <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> toml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;toml&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> yaml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;yaml&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> json5 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;json5&quot;</span><span class="token punctuation">)</span>

<span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token string">&quot;/\.js$/&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">exclude</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  		<span class="token literal-property property">use</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">options</span><span class="token operator">:</span><span class="token punctuation">{</span>
          <span class="token literal-property property">presets</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">]</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-代码分离" tabindex="-1"><a class="header-anchor" href="#_7-代码分离"><span>7. 代码分离</span></a></h2><h3 id="_7-1修改-entry" tabindex="-1"><a class="header-anchor" href="#_7-1修改-entry"><span>7.1修改 entry</span></a></h3><blockquote><p>缺点 公共文件重复打包</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">entry</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">index</span><span class="token operator">:</span><span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
   <span class="token literal-property property">another</span><span class="token operator">:</span><span class="token string">&quot;./src/another-module.js&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 同时需要修改 output 的 filename</span>
<span class="token literal-property property">output</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token string">&quot;[name].bundle.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-2-防止重复打包" tabindex="-1"><a class="header-anchor" href="#_7-2-防止重复打包"><span>7.2 防止重复打包</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 方法一</span>

<span class="token literal-property property">entry</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">index</span><span class="token operator">:</span><span class="token punctuation">{</span>
  	<span class="token keyword">import</span><span class="token operator">:</span><span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">dependOn</span><span class="token operator">:</span><span class="token string">&quot;shared&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">another</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token keyword">import</span><span class="token operator">:</span><span class="token string">&quot;./src/another-module.js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">dependOn</span><span class="token operator">:</span><span class="token string">&quot;shared&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">shared</span><span class="token operator">:</span><span class="token string">&quot;lodash&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 同时需要修改 output 的 filename</span>

  
<span class="token comment">// 方法二</span>
  
<span class="token literal-property property">entry</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">index</span><span class="token operator">:</span><span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">another</span><span class="token operator">:</span><span class="token string">&quot;./src/another-module.js&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 同时需要修改 output 的 filename</span>
  
<span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">splitChunks</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token literal-property property">chunks</span><span class="token operator">:</span><span class="token string">&#39;all&#39;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-3-动态导入" tabindex="-1"><a class="header-anchor" href="#_7-3-动态导入"><span>7.3 动态导入</span></a></h3><p>通过import实现动态引入，且不影响其他模块抽离方式</p><p>async-module.js 假设为功能模块</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// async-module.js</span>
<span class="token keyword">function</span> <span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;lodash&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token keyword">default</span><span class="token operator">:</span>_<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span>
    element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;hello&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;webpack&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&#39; &#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> element
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>在其他的里面使用</p></blockquote><h3 id="_7-4-懒加载" tabindex="-1"><a class="header-anchor" href="#_7-4-懒加载"><span>7.4 懒加载</span></a></h3><p>可以加快应用的初始载入速度，减轻总体积</p><p>依旧通过import直接引入模块，区别在于：何时调用何时加载模块</p><p>节省流量的加载</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>button<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;./math.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>add<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>模块别名</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName:&#39;math&#39; */</span><span class="token string">&#39;./math.js&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_7-5-预获取预加载" tabindex="-1"><a class="header-anchor" href="#_7-5-预获取预加载"><span>7.5 预获取预加载</span></a></h3><p>在声明import时，使用下面这些内置指令，可以让webpack输出“resource hint（资源提示）”，来告知浏览器：</p><pre><code>&lt;p style=&quot;color:red&quot;&gt;prefetch（预获取）：将来某些导航下可能需要的资源 ，即在浏览器网络空闲时再获取资源&lt;/p&gt;
</code></pre><p>preload（预加载）：当前导航下可能需要资源，和懒加载效果类似</p><p>​ 依旧在import引入时的注释中添加</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span>
button<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">&#39;点击执行加法运算&#39;</span>
button<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName:&#39;math&#39;,webpackPrefetch:true */</span><span class="token string">&#39;./math.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>add<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//button.addEventListener(&#39;click&#39;,()=&gt;{</span>
<span class="token comment">//  import(/* webpackChunkName:&#39;math&#39;,webpackPreload:true */&#39;./math.js&#39;).then(({add})=&gt;{</span>
<span class="token comment">//    console.log(add(4,5));</span>
<span class="token comment">//  })</span>
<span class="token comment">//})</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_8-缓存" tabindex="-1"><a class="header-anchor" href="#_8-缓存"><span>8. 缓存</span></a></h2><p>打包后的dist文件部署到服务器以后便能被浏览器客户端所访问，因浏览器的解析特性会优先选择缓存资源，我们要确保文件发生更新时浏览器能识别到，所以需要对输出文件的文件名做处理。</p><h3 id="_8-1-修改输出文件的文件名" tabindex="-1"><a class="header-anchor" href="#_8-1-修改输出文件的文件名"><span>8.1 修改输出文件的文件名</span></a></h3><p>我们可以通过替换 output.filename 中的 substitutions 设置，来定义输出文件的名称。webpack提供了一种使用 **substitution （可替换模板字符串）**的方式，通过带括号字符串来模板化文件名，其中，[contenthash] substitution 将根据资源内容创建出唯一的hash。当资源内容发生变化时， [contenthash] 也会发生变化。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">output</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token operator">...</span>
      <span class="token literal-property property">assetModuleFilename</span><span class="token operator">:</span><span class="token string">&#39;images/[contenthash][ext]&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-2-缓存第三方库" tabindex="-1"><a class="header-anchor" href="#_8-2-缓存第三方库"><span>8.2 缓存第三方库</span></a></h3><p>将第三方库 (library) (例如 lodash) 提取到单独的 vendor chunk 文件中，是比较推荐的做法，第三方库文件很少像本地源码会频繁修改，所以我们可以利用client的长效缓存机制，命中缓存来消除请求，并减少向server 获取资源，同时保证client和server的代码一致。</p><blockquote><p>在splitChunks中定义cacheGroups缓存组。</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>	<span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token operator">...</span>
      <span class="token literal-property property">splitChunks</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>
        <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span><span class="token punctuation">{</span>
          <span class="token literal-property property">vendor</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;vendors&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">chunks</span><span class="token operator">:</span><span class="token string">&#39;all&#39;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-2-汇总js文件" tabindex="-1"><a class="header-anchor" href="#_8-2-汇总js文件"><span>8.2 汇总js文件</span></a></h3><p>在output.filename加上scripts前缀即可汇总js文件至指定文件夹下生成。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">output</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token string">&#39;scripts/[name].[contenthash].js&#39;</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9-拆分开发环境和生成环境" tabindex="-1"><a class="header-anchor" href="#_9-拆分开发环境和生成环境"><span>9.拆分开发环境和生成环境</span></a></h2><h3 id="_9-1-公共路径" tabindex="-1"><a class="header-anchor" href="#_9-1-公共路径"><span>9.1 公共路径</span></a></h3><blockquote><p>publicPath 配置选项在各种场景中都非常有用，你可以通过它来指定应用程序中所有资源的基础路径。</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">output</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token string">&#39;scripts/[name].[contenthash].js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;./dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">clean</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">assetModuleFilename</span><span class="token operator">:</span><span class="token string">&#39;images/[contenthash][ext]&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">publicPath</span><span class="token operator">:</span><span class="token string">&#39;http://localhost:8080/&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_9-2-环境变量" tabindex="-1"><a class="header-anchor" href="#_9-2-环境变量"><span>9.2 环境变量</span></a></h3><blockquote><p>npx webpack --env production 可以通过命令传入变量区分环境</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_9-3-压缩代码" tabindex="-1"><a class="header-anchor" href="#_9-3-压缩代码"><span>9.3 压缩代码</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> terser-webpack-plugin <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> TerserWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;terser-webpack-plugin&quot;</span><span class="token punctuation">)</span>


<span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">minimizer</span><span class="token operator">:</span><span class="token punctuation">[</span>
     <span class="token keyword">new</span> <span class="token class-name">TerserWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_9-4-拆分配置文件" tabindex="-1"><a class="header-anchor" href="#_9-4-拆分配置文件"><span>9.4 拆分配置文件</span></a></h3><p>新建文件夹 config</p><p>新建文件 webpack.config.dev.js</p><p>新建文件 webpack.config.prod.js</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>npx webpack <span class="token parameter variable">-c</span> ./config/webpack.config.dev.js
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>修改配置文件夹里面的输出文件的位置</p></blockquote><blockquote><p>启动一个服务</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>npx webpack serve <span class="token parameter variable">-c</span> ./config/webpack.config.dev.js
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_9-5-npm命令配置" tabindex="-1"><a class="header-anchor" href="#_9-5-npm命令配置"><span>9.5 npm命令配置</span></a></h3><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> &quot;webpack serve -c ./config/webpack.config.dev.js<span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack -c ./config/webpack.config.prod.js &quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>关闭生产环境打包的文件过大警告提示 webpack.config</p></blockquote><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>performance<span class="token operator">:</span><span class="token punctuation">{</span>
    hints<span class="token operator">:</span><span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_9-6-提取公共配置" tabindex="-1"><a class="header-anchor" href="#_9-6-提取公共配置"><span>9.6 提取公共配置</span></a></h3><p>新建文件 webpack.config.common.js</p><blockquote><p>合并配置</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i webpack-merge <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>新建文件 webpack.config.js</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>merge<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack-merge&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./webpack.config.common&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> productionConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./webpack.config.prod&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> developmentConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./webpack.config.dev&#39;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">case</span> env<span class="token punctuation">.</span>development<span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span>developmentConfig<span class="token punctuation">)</span>
    <span class="token keyword">case</span> env<span class="token punctuation">.</span>production<span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span>productionConfig<span class="token punctuation">)</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;No matching configuration was found&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：package.json中的config文件路径需统一为新创建的config文件，且需要添加环境变量</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>&quot;scripts&quot;: {
    &quot;start&quot;: &quot;webpack serve -c ./config/webpack.config.js --env development&quot;,
    &quot;build&quot;: &quot;webpack -c ./config/webpack.config.js --env production&quot;
},
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="高级篇" tabindex="-1"><a class="header-anchor" href="#高级篇"><span>高级篇</span></a></h1><h2 id="_1-source-map" tabindex="-1"><a class="header-anchor" href="#_1-source-map"><span>1. source map</span></a></h2><p>在开发过程中提供源码支持，便于开发者使用，又细分为以下7种。</p><table><thead><tr><th>模式</th><th>作用</th></tr></thead><tbody><tr><td>eval</td><td>每个module会封装到eval里包裹起来执行，并且会在末尾追加注释</td></tr><tr><td>source-map</td><td>生成一个SourceMap文件</td></tr><tr><td>hidden-source-map</td><td>和source-map一样，但不会在bundle末尾追加注释</td></tr><tr><td>inline-source-map</td><td>生成一个DataUrl形式的SourceMap文件</td></tr><tr><td>eval-source-map</td><td>每个module会通过eval（）来执行，并生成一个DataUrl形式的SourceMap</td></tr><tr><td>cheap-source-map</td><td>生成一个没有列信息（column-mappings）的SourceMaps文件，不包含loader的sourcemap（譬如babel的sourcemap）</td></tr><tr><td>cheap-module-source-map</td><td>生成一个没有列信息（column-mappings）的SourceMaps文件，同时loader的sourcemap也被简化为只包含对应行的。</td></tr></tbody></table><blockquote><p>开发环境推荐使用 cheap-module-source-map</p></blockquote><p>注意：生产环境一般不会开启sourcemap功能，有2点原因：</p><ul><li>通过bundle和sourcemap文件，可以反编译出源码——也就是说，线上有sourcemap文件的话就意味着有暴露源码的风险</li><li>sourcemap文件的体积相对巨大，不宜放在生产环境</li></ul><h2 id="_2-devserver" tabindex="-1"><a class="header-anchor" href="#_2-devserver"><span>2. devServer</span></a></h2><p>开发环境下，我们往往需要启动一个web服务，方便我们模拟一个用户从浏览器中访问服务，读取打包产物，以此观测代码在客户端的表现，webpack内置了这样的功能，我们只需要简单配置就可以开启。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code> <span class="token function">npm</span> <span class="token function">install</span> webpack-dev-server <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">devServer</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token keyword">static</span><span class="token operator">:</span><span class="token string">&#39;./dist&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">compress</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 配置是否压缩文件传输</span>
        port：<span class="token string">&#39;3000&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 运行端口号</span>
        <span class="token literal-property property">headers</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token string-property property">&#39;X-Access-Token&#39;</span><span class="token operator">:</span><span class="token string">&#39;123213&#39;</span> <span class="token comment">// 自定义头部</span>
    	<span class="token punctuation">}</span>，
        <span class="token literal-property property">proxy</span><span class="token operator">:</span><span class="token punctuation">{</span>
        	<span class="token string-property property">&#39;/api&#39;</span><span class="token operator">:</span><span class="token string">&#39;http://localhost:9000&#39;</span> <span class="token comment">// 配置代理  一般用来解决快鱼的问题</span>
    	<span class="token punctuation">}</span>，
        <span class="token literal-property property">https</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 设置https协议</span>
        <span class="token literal-property property">http2</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> 
        historyApiFallBack：<span class="token boolean">true</span><span class="token punctuation">,</span>
				<span class="token literal-property property">host</span><span class="token operator">:</span><span class="token string">&#39;0.0.0.0&#39;</span> <span class="token comment">//如果在开发环境中启动了一个devserve服务，并期望其他人能访问到，只需要配置该项即可</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>webpack-dev-sever是静态资源服务器，他会通过你的output配置去读取文件，通过’/’分割以文件查找的模式匹配文件。这样自然就产生问题了，因为你配置的路由并不是实际存在的文件，根据文件查找的方式是找不到的，只会404。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token literal-property property">publicPath</span><span class="token operator">:</span><span class="token string">&quot;/&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-模块热替换与热加载" tabindex="-1"><a class="header-anchor" href="#_3-模块热替换与热加载"><span>3. 模块热替换与热加载</span></a></h2><p>模块热替换：</p><p>模块热替换（HMR - hot module replacement）功能会在应用程序运行过程中，替换、添加或删除 模块 ，而无需重新加载整个页面。</p><p>启用webpack的热模块替换特性，需要配置devServer.hot 参数</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">devServer</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>
        <span class="token literal-property property">hot</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">liveReload</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 热加载 新版webpack-dev-server默认已经开启热加载功能</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>自定义模块可以用hot.accept方法来实现热替换</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">if</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span><span class="token punctuation">{</span>
    module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">&#39;./input.js&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-eslint" tabindex="-1"><a class="header-anchor" href="#_4-eslint"><span>4. eslint</span></a></h2><p>多人协同开发时，用以规范代码格式的工具</p><p>本地安装eslint</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i eslint <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>运行 npx eslint --init 初始化eslint配置</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;env&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;browser&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 支持运行在浏览器中</span>
        <span class="token property">&quot;es2021&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 支持es2021</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;airbnb-base&quot;</span> <span class="token comment">// 支持的扩展文件</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;parserOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;ecmaVersion&quot;</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token comment">// ecmaVersion 版本</span>
        <span class="token property">&quot;sourceType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    	<span class="token comment">//启用的规则</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;globals&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-1借助-webpack" tabindex="-1"><a class="header-anchor" href="#_4-1借助-webpack"><span>4.1借助 webpack</span></a></h3><p>​ 运行eslint检查： npx eslint 目录</p><p>​ 当项目中其他人没有安装eslint插件至IDE时，可以加装webpack插件来支持eslint</p><p>​ 本地安装babel-loader、eslint-webpack-plugin</p><p>​ npm install babel-loader eslint-webpack-plugin -D</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
		<span class="token literal-property property">use</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&#39;bable-loader&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;eslint-webpack-plugin&#39;</span><span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>关闭网页 eslint 的错误提示</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">devServer</span><span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token literal-property property">client</span><span class="token operator">:</span><span class="token punctuation">{</span>
  	<span class="token literal-property property">overlay</span><span class="token operator">:</span><span class="token boolean">false</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-git-hooks与husky" tabindex="-1"><a class="header-anchor" href="#_5-git-hooks与husky"><span>5. git-hooks与husky</span></a></h2><p>为保证团队的开发人员提交代码时符合规范，可以选择在上传代码时进行校验，我们常用husky来协助代码提交时的eslint校验。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">git</span> init
<span class="token function">ls</span> <span class="token parameter variable">-la</span> <span class="token comment"># 显示所有的文件包括隐藏的文件</span>
<span class="token builtin class-name">cd</span> .git
<span class="token builtin class-name">cd</span> hooks
<span class="token function">touch</span> pre-commit
<span class="token function">vim</span> pre-commit

	<span class="token builtin class-name">echo</span> pre-commit <span class="token comment"># 终端打印</span>
	npx eslint ./src
<span class="token comment"># 修改文件的读写权限</span>
chomd +x ./pre-commit
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修.git 中默认路径,读取自定义的路径</p><p>新建文件夹.mygithooks 新建文件 pre-commit</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">git</span> config core.hooksPath .mygithoos
chomd +x .mygithooks/pre-commit
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-1-使用-husky-完成以上功能" tabindex="-1"><a class="header-anchor" href="#_5-1-使用-husky-完成以上功能"><span>5.1 使用 husky 完成以上功能</span></a></h3><p><a href="https://typicode.github.io/husky/" target="_blank" rel="noopener noreferrer">官网地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i husky <span class="token parameter variable">-D</span>
npx husky <span class="token function">install</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>fix package.json</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;script&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;prepare&quot;</span><span class="token operator">:</span><span class="token string">&quot;husky install&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>创建 hook</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>npx husky <span class="token function">add</span> .husky/pre-commit <span class="token string">&quot;npm test&quot;</span>

<span class="token comment">#然后在.husky 中生成了一个文件 如果是空白,则添加 npx eslint ./src</span>
<span class="token comment"># 授权 chomd +x .husky/pre-commit</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-模块解析-resolve" tabindex="-1"><a class="header-anchor" href="#_6-模块解析-resolve"><span>6. 模块解析（resolve）</span></a></h2><blockquote><p>不同时期模块的引入和导出</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// ECMAScript 模块</span>
<span class="token keyword">import</span> a <span class="token keyword">from</span> <span class="token string">&quot;./a&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> a
<span class="token comment">// CommonJS 模块</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./a&quot;</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> a
<span class="token comment">// AMD 模块</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;./a.js&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;./b.js&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>webpack通过Resolvers实现了模块之间的依赖与引用</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> _ form <span class="token string">&#39;lodash&#39;</span>

<span class="token keyword">const</span> add <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./utils/add&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>所引用的模块可以是来自应用程序的代码，也可以是第三方库。resolver帮助webpack从每个require/import 语句中，找到需要引入到bundle中的模块代码。当打包模块时，webpack使用enhanced-resolve 来解析文件路径。</p><h3 id="_6-1-webpack中的模块路径解析规则" tabindex="-1"><a class="header-anchor" href="#_6-1-webpack中的模块路径解析规则"><span>6.1 webpack中的模块路径解析规则</span></a></h3><p>通过内置的enhanced-resolve，webpack能解析三种文件路径</p><h4 id="_6-1-1绝对路径" tabindex="-1"><a class="header-anchor" href="#_6-1-1绝对路径"><span>6.1.1绝对路径</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">&#39;/home/me/file&#39;</span>
<span class="token keyword">import</span> <span class="token string">&#39;C:\\Users\\me\\file&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>由于已经获得文件的绝对路径，因此不需要再做进一步解析</p><h4 id="_6-1-2相对路径" tabindex="-1"><a class="header-anchor" href="#_6-1-2相对路径"><span>6.1.2相对路径</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">&#39;../utils/reqFetch&#39;</span>
<span class="token keyword">import</span> <span class="token string">&#39;./styles.css&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>这种情况下，使用import或require的资源文件所处的目录，被认为是上下文目录。在import/require中给定的相对路径，enhanced-resolve会拼接此上下文路径，来生成模块的绝对路劲path.resolve(__dirname,RelativePath)。</p><h4 id="_6-1-3-路径别名" tabindex="-1"><a class="header-anchor" href="#_6-1-3-路径别名"><span>6.1.3 路径别名</span></a></h4><blockquote><p>修改 webpack</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span>
<span class="token literal-property property">resolve</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">alias</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;@&quot;</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&quot;./src&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-1-4修改默认的引入扩展名" tabindex="-1"><a class="header-anchor" href="#_6-1-4修改默认的引入扩展名"><span>6.1.4修改默认的引入扩展名</span></a></h4><p>当引入的时候没有填写文件的扩展名,按照数组的顺序引入对应的后缀文件</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">extensions</span><span class="token operator">:</span><span class="token punctuation">[</span>
  <span class="token string">&quot;.json&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;js&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;.vue&quot;</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-2-外部扩展" tabindex="-1"><a class="header-anchor" href="#_6-2-外部扩展"><span>6.2 外部扩展</span></a></h3><p>有时我们为了减小bundle体积，会把一些不变的第三方库用cdn的形式引入。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">externalsType</span><span class="token operator">:</span><span class="token string">&#39;script&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 选择加载类型</span>
    <span class="token literal-property property">externals</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">jquery</span><span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token string">&#39;https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;$&#39;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-3-依赖图" tabindex="-1"><a class="header-anchor" href="#_6-3-依赖图"><span>6.3 依赖图</span></a></h3><p>每当一个文件依赖另一个文件时，webpack会直接将文件视为存在依赖关系。这使得webpack可以获取非代码资源，如images或web字体等。并会把它们作为依赖提供给应用程序。</p><p>当webpack开始工作时，他会根据我们的配置，从entry开始递归构建一个依赖关系图，其中包含着应用程序所需的每个模块，然后将所有模块打包为bundle（也就是output的配置项）。</p><p>bundle analysis工具：</p><ul><li><p>**webpack-chart：**webpack stats 可交互饼图</p></li><li><p>**webpack-visualizer：**可视化bundle，检查模块占用空间及重复使用</p></li><li><p>**webpack-bundle-analyzer：**一个plugin和CLI工具，它将bundle内容展示为一个便捷的、交互式、可缩放的树状图形式</p></li><li><p>**webpack bundle optimize helper：**可以分析bundle，并提供可操作的改进措施，以减少包体积大小</p></li><li><p>**bundle-stats：**生成一个bundle报告（大小、资源、模块），并自动比较不同构建之间的结果。</p></li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i webpack-bundle-analyzer <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>BundleAnalyzerPlugin<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-bundle-analyzer&quot;</span><span class="token punctuation">)</span>
<span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-扩展功能" tabindex="-1"><a class="header-anchor" href="#_7-扩展功能"><span>7. 扩展功能</span></a></h2><h3 id="_7-1-postcss和css模块" tabindex="-1"><a class="header-anchor" href="#_7-1-postcss和css模块"><span>7.1 PostCSS和CSS模块</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> postcss-loader autoprefixser <span class="token parameter variable">-D</span>
<span class="token function">npm</span> i postcss-nested <span class="token parameter variable">-D</span>  <span class="token comment"># 可以使用 less sass 嵌套语法</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>新建文件postcss.config.js至根目录下，并配置</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;autoprefixer&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;postcss-nested&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">use</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token string">&#39;style-loader&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token literal-property property">modules</span><span class="token operator">:</span><span class="token boolean">true</span> <span class="token comment">// 开启 css 模块化</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&#39;postcss-loader&#39;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意，还需在package.json中配置浏览器列表以实现兼容效果</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;browserslist&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token string">&quot;&gt; 1%&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;last 2 versions&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-2-web-worker" tabindex="-1"><a class="header-anchor" href="#_7-2-web-worker"><span>7.2 Web Worker</span></a></h3><p>webpack5自带，不需要安装loader就能在webpack中使用：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 假设work.js代码如下</span>
self<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  self<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">answer</span><span class="token operator">:</span><span class="token number">1111</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 在其他js中引入并调用即可</span>
<span class="token keyword">const</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">&#39;./work.js&#39;</span><span class="token punctuation">,</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>

worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">question</span><span class="token operator">:</span><span class="token string">&#39;喂喂喂&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
worker<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-3-typescript" tabindex="-1"><a class="header-anchor" href="#_7-3-typescript"><span>7.3 TypeScript</span></a></h3><p>webpack也提供typescript的良好支持</p><p>安装typescript：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> typescript ts-loader <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>初始化ts配置：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>npx tsc <span class="token parameter variable">--init</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>并修改tsconfig.json中的文件目录</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>   
    ...
	<span class="token property">&quot;rootDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./src&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;outDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./dist&quot;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 这里只修改了输入和输出文件目录</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注：在ts中引入的第三方库需要单独进行下载，如 npm install @types/loadsh -D 一样</p><h3 id="_7-4-多页面应用" tabindex="-1"><a class="header-anchor" href="#_7-4-多页面应用"><span>7.4 多页面应用</span></a></h3><h4 id="entry配置" tabindex="-1"><a class="header-anchor" href="#entry配置"><span>entry配置</span></a></h4><p>当需要适配多页面应用时，可以通过配置entry来支持</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">main</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token keyword">import</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&#39;./src/app.js&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;./src/work.js&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">dependOn</span><span class="token operator">:</span><span class="token string">&#39;lodash&#39;</span> 
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">main2</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token keyword">import</span><span class="token operator">:</span><span class="token string">&#39;./src/craft.js&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">dependOn</span><span class="token operator">:</span><span class="token string">&#39;lodash&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lodash</span><span class="token operator">:</span><span class="token string">&#39;lodash&#39;</span> <span class="token comment">// 共用第三方库时可整合在一起</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="index-html-模板配置" tabindex="-1"><a class="header-anchor" href="#index-html-模板配置"><span>index.html 模板配置</span></a></h4><p>想要自定义一些html相关的配置项时，可以通过htmlwebpackplugin的模板配置生成</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
	<span class="token operator">...</span>
	<span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token punctuation">[</span>
		<span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">title</span><span class="token operator">:</span><span class="token string">&#39;多页面应用&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">&#39;./index.html&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">inject</span><span class="token operator">:</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 定义script标签的生成位置</span>
            <span class="token literal-property property">chunks</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&#39;main&#39;</span><span class="token punctuation">]</span> <span class="token comment">// webpack会默认根据entry自动生成chunks，手动配置以后只会生成对应键的chunks </span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">main</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token keyword">import</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&#39;./src/app.js&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;./src/work.js&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">dependOn</span><span class="token operator">:</span><span class="token string">&#39;lodash&#39;</span> 
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">main2</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token keyword">import</span><span class="token operator">:</span><span class="token string">&#39;./src/craft.js&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">dependOn</span><span class="token operator">:</span><span class="token string">&#39;lodash&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lodash</span><span class="token operator">:</span><span class="token string">&#39;lodash&#39;</span> <span class="token comment">// 共用第三方库时可整合在一起</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html line-numbers-mode" data-ext="html" data-title="html"><pre class="language-html"><code>// 并在html中添加对应配置
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>&lt;%= htmlWebpackPlugin.options.title %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-5-try-shaking" tabindex="-1"><a class="header-anchor" href="#_7-5-try-shaking"><span>7.5 Try Shaking</span></a></h3><p>当 Javascript 项目达到一定体积时，将代码分成模块会更易于管理。</p><p>但是，当这样做时，我们最终可能会导入实际上未使用的代码。Tree Shaking 是一种通过消除最终文件中未使用的代码来优化体积的方法。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>
      <span class="token literal-property property">mode</span><span class="token operator">:</span><span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">usedExports</span><span class="token operator">:</span><span class="token boolean">true</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="sideeffects" tabindex="-1"><a class="header-anchor" href="#sideeffects"><span>sideEffects</span></a></h4><p>tree-shaking 会导致无差别删除代码，我们可以通过配置sideEffects来手动调节模块</p><p>在package.json中编辑，下方示例即为对css后缀的文件不过滤</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;sideEffects&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;*.css&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-6-渐进式网络应用程序-pwa" tabindex="-1"><a class="header-anchor" href="#_7-6-渐进式网络应用程序-pwa"><span>7.6 渐进式网络应用程序 PWA</span></a></h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/Progressive_web_apps/Tutorials/js13kGames" target="_blank" rel="noopener noreferrer">了解详情<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>简而言之，PWA是一个网站，但是它们采用了最新的Web标准来允许在用户在设备上安装它。他提供了和App一样的用户体验。当没有网络连接时，它可以离线使用，它可以缓存上一次联网交互过程中的数据。它将App应用程序的外观美感和网站的易开发特性融合在了一起。</p><p>这里主要使用 http-server 来体验</p><p>本地安装 http-server</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> http-server --save-dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>注意：默认情况下，webpack DevServer 会写入到内存。我们需要启用 devserverdevmiddleware.writeToDisk 配置项，来让 http-server 处理 ./dist 目录中的文件</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">devServer</span><span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token literal-property property">devMiddleWare</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">index</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">writeToDisk</span><span class="token operator">:</span><span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在package.json中配置脚本</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;start&quot;</span><span class="token operator">:</span><span class="token string">&quot;http-server dist&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="添加workbox" tabindex="-1"><a class="header-anchor" href="#添加workbox"><span>添加Workbox</span></a></h4><p>添加 workbox-webpack-plugin 插件，然后调整 webpack.config.js 文件</p><p>以实现离线环境下依然能够访问应用</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> workbox-webpack-plugin --save-dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> WorkboxPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;workbox-webpack-plugin&#39;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">WorkboxPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token comment">// 这些选项帮助快速启用 ServiceWorkers</span>
            <span class="token comment">// 不允许遗留任何“旧的” ServiceWorkers</span>
            <span class="token literal-property property">clientsClaims</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">skipWaiting</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="注册service-worker" tabindex="-1"><a class="header-anchor" href="#注册service-worker"><span>注册Service-Worker</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">&#39;serviceWorker&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span><span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;load&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">{</span>
        navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&#39;/service-worker.js&#39;</span><span class="token punctuation">)</span>
    	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">registration</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;SW 注册成功&#39;</span><span class="token punctuation">,</span>registration<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    	<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">registrationError</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;SW 注册失败&#39;</span><span class="token punctuation">,</span>registrationError<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-7-shimming-预置依赖" tabindex="-1"><a class="header-anchor" href="#_7-7-shimming-预置依赖"><span>7.7 shimming 预置依赖</span></a></h3><p>将模块添加至全局，比如lodash直接定义为全局变量</p><h4 id="shimming预置全局变量" tabindex="-1"><a class="header-anchor" href="#shimming预置全局变量"><span>shimming预置全局变量</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack&#39;</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token comment">// 将下划线指定为全局变量</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProvidPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">_</span><span class="token operator">:</span><span class="token string">&#39;lodash&#39;</span> 
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="细粒度-shimming" tabindex="-1"><a class="header-anchor" href="#细粒度-shimming"><span>细粒度 Shimming</span></a></h4><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i imports-loader <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>一些遗留模块依赖的 <span style="color:red;">this 指向的是 window 对象</span>。在rules中配置imports以覆盖exports的指向</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
	<span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token literal-property property">test</span><span class="token operator">:</span>require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;./src/index.js&#39;</span><span class="token punctuation">)</span>
                <span class="token literal-property property">use</span><span class="token operator">:</span><span class="token string">&#39;imports-loader?wrapper=window&#39;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="全局exports" tabindex="-1"><a class="header-anchor" href="#全局exports"><span>全局exports</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
	<span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token comment">// 全局定义 了commonjs的导出方法来导出file变量</span>
            <span class="token punctuation">{</span>
                <span class="token literal-property property">test</span><span class="token operator">:</span>require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;./src/global.js&#39;</span><span class="token punctuation">)</span>
                <span class="token literal-property property">use</span><span class="token operator">:</span><span class="token string">&#39;exports-loader?type=commonjs&amp;exports=file,multiple|helpers.parse|parse&#39;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-8-加载polyfills" tabindex="-1"><a class="header-anchor" href="#_7-8-加载polyfills"><span>7.8 加载polyfills</span></a></h3><p><strong>注：现目前建议不再使用polyfill，而是改为core.js</strong></p><p>本地安装 polyfill</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> @babel/polyfill <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后直接引入到主bundle文件中</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">&#39;@babel/polyfill&#39;</span>

<span class="token comment">// 当前主bundle文件</span>
<span class="token comment">// 业务代码</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="进一步优化polyfills" tabindex="-1"><a class="header-anchor" href="#进一步优化polyfills"><span>进一步优化polyfills</span></a></h4><p>不建议直接使用 Import @babel/polyfill 。会导致全局引入整个polyfill 包，体积大且污染全局环境。</p><p>babel-preset-env package 通过 browserlist 来转译那些浏览器中不支持的特性。preset使用 useBuiltIns 选项，默认false，这种方式可以将全局 babel-polyfill 导入，改进为细粒度更高的import格式</p><blockquote><p>本地安装 @babel/preset-env 及相关包</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> core-js@3 babel-loader @babel/core @babel/preset-env <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在webpack.config.js中配置</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
	<span class="token operator">...</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token literal-property property">exclude</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token literal-property property">use</span><span class="token operator">:</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token string">&#39;babel-loader&#39;</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">options</span><span class="token operator">:</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">presets</span><span class="token operator">:</span><span class="token punctuation">[</span>
                            <span class="token punctuation">[</span>
                                
                                <span class="token string">&#39;@babel/preset-env&#39;</span><span class="token punctuation">,</span>
                                <span class="token punctuation">{</span>
                                    <span class="token literal-property property">targets</span><span class="token operator">:</span><span class="token punctuation">[</span>
                                        <span class="token string">&#39;last 1 version&#39;</span><span class="token punctuation">,</span>
                                        <span class="token string">&#39;&gt; 1%&#39;</span>
                                    <span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    <span class="token literal-property property">useBuiltIns</span><span class="token operator">:</span><span class="token string">&#39;usage&#39;</span><span class="token punctuation">,</span>
                                    <span class="token literal-property property">corejs</span><span class="token operator">:</span><span class="token number">3</span>
                                <span class="token punctuation">}</span>
                            <span class="token punctuation">]</span>
                        <span class="token punctuation">]</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-9-构建library" tabindex="-1"><a class="header-anchor" href="#_7-9-构建library"><span>7.9 构建Library</span></a></h3><p>配置 webpack.config.js</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span><span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span><span class="token string">&#39;./src/app.js&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">experiments</span><span class="token operator">:</span><span class="token punctuation">{</span> <span class="token comment">//当library类型为module时 此项必填</span>
	<span class="token literal-property property">outputModule</span><span class="token operator">:</span><span class="token boolean">true</span> 
  <span class="token punctuation">}</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token string">&#39;mylib.js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">library</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token comment">// name:&#39;mylib&#39;, 当type为module时，不需要name</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&#39;module&#39;</span> <span class="token comment">// 可选 commonjs </span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>想要同时支持commonJs和module时，使用umd规范配置</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token operator">...</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token string">&#39;mylib.js&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">library</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;mylib&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&#39;umd&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">globalObject</span><span class="token operator">:</span><span class="token string">&#39;globalThis&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="创建一个library" tabindex="-1"><a class="header-anchor" href="#创建一个library"><span>创建一个library</span></a></h4><p>使用npm初始化项目后，安装webpack、webpack-cli 和 lodash</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> init <span class="token parameter variable">-y</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> webpack webpack-cli lodash <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>将lodash安装位devDependencies 而非 dependencies ，这样就不需要打包到库，减少包体积</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token operator">...</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token string">&#39;mylib.js&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">library</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;mylib&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&#39;umd&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">globalObject</span><span class="token operator">:</span><span class="token string">&#39;globalThis&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">externals</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">lodash</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token literal-property property">commonjs</span><span class="token operator">:</span><span class="token string">&#39;lodash&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">amd</span><span class="token operator">:</span><span class="token string">&#39;lodash&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">root</span><span class="token operator">:</span><span class="token string">&#39;_&#39;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="发布为npm-package" tabindex="-1"><a class="header-anchor" href="#发布为npm-package"><span>发布为npm-package</span></a></h4><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> config get registry
<span class="token function">npm</span> adduser
// 然后输入用户名密码邮箱登录
<span class="token function">npm</span> publish
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-10-模块联邦-module-federation" tabindex="-1"><a class="header-anchor" href="#_7-10-模块联邦-module-federation"><span>7.10 模块联邦（Module Federation）</span></a></h3><p>模块联邦是 Webpack5 新内置的一个重要功能，可以让跨应用间真正做到模块共享， <a href="https://link.zhihu.com/?target=https%3A//indepth.dev/webpack-5-module-federation-a-game-changer-in-javascript-architecture/%23its-important-to-note-these-are-special-entry-points-they-are-only-a-few-kb-in-size-containing-a-special-webpack-runtime-that-can-interface-with-the-host-it-is-not-a-standard-entry-point--7/" target="_blank" rel="noopener noreferrer">webpack-5-module-federation-a-game-changer-in-javascript-architecture<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 这篇文章了解什么是 “模块联邦” 功能。</p><p>原知乎链接：https://zhuanlan.zhihu.com/p/115403616</p><h4 id="使用模块联邦" tabindex="-1"><a class="header-anchor" href="#使用模块联邦"><span>使用模块联邦</span></a></h4><p>模块联邦本身是一个普通的 Webpack 插件 <code>ModuleFederationPlugin</code>，插件有几个重要参数：</p><p><code>name</code> 当前应用名称，需要全局唯一。</p><p><code>remotes</code> 可以将其他项目的 <code>name</code> 映射到当前项目中。</p><p><code>exposes</code> 表示导出的模块，只有在此申明的模块才可以作为远程依赖被使用。</p><p><code>shared</code> 是非常重要的参数，制定了这个参数，可以让远程加载的模块对应依赖改为使用本地项目的 React 或 ReactDOM。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> ModuleFederationPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>container
module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token operator">...</span>
        <span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;nav&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token string">&#39;remoteEntry.js&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">remote</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token literal-property property">app_two</span><span class="token operator">:</span> <span class="token string">&quot;app_two_remote&quot;</span><span class="token punctuation">,</span>
        		<span class="token literal-property property">app_three</span><span class="token operator">:</span> <span class="token string">&quot;app_three_remote&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">exposes</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token literal-property property">AppContainer</span><span class="token operator">:</span> <span class="token string">&quot;./src/App&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">shared</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react-dom&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react-router-dom&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>比如设置了 <code>remotes: { app_tw0: &quot;app_two_remote&quot; }</code>，在代码中就可以直接利用以下方式直接从对方应用调用模块：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Search <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;app_two/Search&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这个 <code>app_two/Search</code> 来自于 <code>app_two</code> 的配置：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// app_two 的 webpack 配置</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;app_two&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">library</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;var&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;app_two&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;remoteEntry.js&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">exposes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">Search</span><span class="token operator">:</span> <span class="token string">&quot;./src/Search&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">shared</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react-dom&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>正是因为 <code>Search</code> 在 <code>exposes</code> 被导出，我们因此可以使用 <code>[name]/[exposes_name]</code> 这个模块，这个模块对于被引用应用来说是一个本地模块。</p><h3 id="_7-11-通用构建优化" tabindex="-1"><a class="header-anchor" href="#_7-11-通用构建优化"><span>7.11 通用构建优化</span></a></h3><h4 id="通用环境提升构建性能" tabindex="-1"><a class="header-anchor" href="#通用环境提升构建性能"><span>通用环境提升构建性能</span></a></h4><p>将webpack和nodeJs更新到最新版本</p><p>将loader应用于最少数量的必要模块</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token literal-property property">include</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__diranme<span class="token punctuation">,</span><span class="token string">&#39;src&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">// 只解析src目录下的文件</span>
                <span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token string">&#39;babel-loader&#39;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="引导-boostrap" tabindex="-1"><a class="header-anchor" href="#引导-boostrap"><span>引导（boostrap）</span></a></h4><p>每个额外的 loader/plugin 都有其启动时间，尽量少地使用工具</p><h4 id="提高解析速度" tabindex="-1"><a class="header-anchor" href="#提高解析速度"><span>提高解析速度</span></a></h4><ul><li><p>减少resolve.modules、resolve.extensions、resolve.mainFiles、resolve.descriptionFiles 中条目数量，因为他们会增加文件系统调用的次数</p></li><li><p>如果不适用symlinks（例如 npm link 或 yarn link），可以设置resolve.symlinks: false</p></li><li><p>如果你使用自对应resolve plugin 规则，并且没有指定context 上下文，可以设置 resolve.cacheWithContext: false</p></li></ul><h4 id="小即是快" tabindex="-1"><a class="header-anchor" href="#小即是快"><span>小即是快</span></a></h4><p>减少编译结果的整体大小，以提高构建性能。尽量保持chunk体积小</p><ul><li><p>使用数量更少/体积更小的 library</p></li><li><p>在多页面应用程序中使用 SplitChunksPlugin，并开启async模式</p></li><li><p>移除未引用代码</p></li><li><p>只编译当前正在开发的代码</p></li></ul><h4 id="持久化缓存" tabindex="-1"><a class="header-anchor" href="#持久化缓存"><span>持久化缓存</span></a></h4><p>在webpack 配置中使用 cache 选项。使用 package.json 中的postinstall 清除缓存目录。</p><p>将 cache 类型设置为内存或者文件系统。memory 选项很简单，它告诉 webpack 在内存中存储缓存，不允许额外的配置：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
	<span class="token comment">//</span>
	<span class="token literal-property property">cache</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&#39;memory&#39;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="自定义-plugin-loader" tabindex="-1"><a class="header-anchor" href="#自定义-plugin-loader"><span>自定义 plugin/loader</span></a></h4><p>对它们进行概要分析，以免在此处引入性能问题</p><h4 id="progress-plugin" tabindex="-1"><a class="header-anchor" href="#progress-plugin"><span>progress plugin</span></a></h4><p>将 ProgressPlugin 从 webpack 中删除，可以缩短一定的构建时间</p><h4 id="dll" tabindex="-1"><a class="header-anchor" href="#dll"><span>dll</span></a></h4><p>使用 DllPlugin 为更改不频繁的代码生成单独的编译结果。这可以提高应用程序的编译速度，尽管它增加了构建过程的复杂度。</p><p>在根目录中新建webpack.dll.config.js</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack&#39;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span><span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token literal-property property">jquery</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&#39;jquery&#39;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token string">&#39;[name].js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;dll&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">library</span><span class="token operator">:</span><span class="token string">&#39;[name]_[hash]&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;[name]_[hash]&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;dll/manifest.json&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>并在package.json 中定义脚本</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span><span class="token string">&quot;webpack --config ./webpack.dll.config.js&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装 add-asset-html-webpack-plugin 并在webpack.conig.js 中配置</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> add-asset-html-webpack-plugin <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> AddAssetHtmlPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;add-asset-html-webpack-plugin&#39;</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span><span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span><span class="token string">&#39;./src/index.js&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">mainfest</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;./dll/manifest.json&#39;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name">AddAssetHtmlPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">filepath</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;./dll/jquery.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token literal-property property">publicPath</span><span class="token operator">:</span><span class="token string">&#39;./&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="worker-池-worker-pool" tabindex="-1"><a class="header-anchor" href="#worker-池-worker-pool"><span>worker 池（worker pool）</span></a></h4><p>thread-loader 可以将非常消耗资源的loader分流给一个 worker pool</p><p>安装相关插件</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> thread-loader babel-loader @babel/core @babel/preset-env <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>配置webpack.config.js</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
	<span class="token operator">...</span>
	<span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
			<span class="token punctuation">{</span>
				<span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				<span class="token literal-property property">exclude</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				<span class="token literal-property property">use</span><span class="token operator">:</span><span class="token punctuation">[</span>
					<span class="token punctuation">{</span>
						<span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token string">&#39;babel-loader&#39;</span><span class="token punctuation">,</span>
						<span class="token literal-property property">options</span><span class="token operator">:</span><span class="token punctuation">{</span>
							<span class="token literal-property property">presets</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&#39;@babel/preset-env&#39;</span><span class="token punctuation">]</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>
                        <span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token string">&#39;thread-loader&#39;</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">options</span><span class="token operator">:</span><span class="token punctuation">{</span>
                            <span class="token literal-property property">workers</span><span class="token operator">:</span><span class="token number">2</span> <span class="token comment">// 调用CPU核心数</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
				<span class="token punctuation">]</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-12-开发环境提升构建性能" tabindex="-1"><a class="header-anchor" href="#_7-12-开发环境提升构建性能"><span>7.12 开发环境提升构建性能</span></a></h3><h4 id="增量编译" tabindex="-1"><a class="header-anchor" href="#增量编译"><span>增量编译</span></a></h4><p>使用webpack的 watch mode（监听模式）。而不使用其他工具来watch文件和调用webpack。内置的watch mode 会记录时间戳并将此信息传递给 compilation 以使缓存失效。</p><p>在某些配置环境中，watch mode 会回退到 pull mode （轮询模式）。监听许多文件会导致 CPU 大量负载。在这些情况下，可以使用 watchOptions.poll 来增加轮询的间隔。</p><h4 id="在内存中编译" tabindex="-1"><a class="header-anchor" href="#在内存中编译"><span>在内存中编译</span></a></h4><p>下面几个工具通过在内存中（而不是写入磁盘）编译和 serve 资源来提高性能：</p><ul><li><p>webpack-dev-server</p></li><li><p>webpack-hot-middleware</p></li><li><p>webpack-dev-middleware</p></li></ul><h4 id="stats-tojson加速" tabindex="-1"><a class="header-anchor" href="#stats-tojson加速"><span>stats.toJson加速</span></a></h4><p>webpack 4 默认使用 stats.toJson() 输出大量数据。除非在增量步骤中做必要统计，否则请避免获取 stats 对象的部分内容。</p><p>webpack-dev-server 在 v3.1.3 以后的版本，包含一个重要的性能修复，即最小化每个增量构建步骤中，从stats对象获取数据量</p><h4 id="devtool" tabindex="-1"><a class="header-anchor" href="#devtool"><span>Devtool</span></a></h4><p>注意：不同的 devtool 设置会导致性能差异</p><ul><li><p>“eval” 具有最好的性能，但并不能转译代码</p></li><li><p>如果接受稍差的 map 质量，可以使用 cheap-source-map 变体配置进行增量编译</p></li><li><p>使用 eval-source-map 变体配置进行增量编译</p></li></ul><p>在多数情况下，最佳选择仍是 eval-cheap-module-source-map</p><h4 id="避免在生产环境才用到的工具" tabindex="-1"><a class="header-anchor" href="#避免在生产环境才用到的工具"><span>避免在生产环境才用到的工具</span></a></h4><p>某些 utility, plugin 和 loader 都只用于生产环境。例如，在开发环境下使用TerserPlugin 来 minify(压缩) 和 mangle(混淆破坏) 代码是没有意义的。通常在开发环境下，应该排除以下这些工具︰</p><ul><li><p>TerserPlugin</p></li><li><p>[fullhash]/[chunkhash]/[contenthash]</p></li><li><p>AggressiveSplittingPlugin</p></li><li><p>AggressiveMergingPlugin</p></li><li><p>ModuleConcatenationPlugin</p></li></ul><h4 id="最小化entry-chunk" tabindex="-1"><a class="header-anchor" href="#最小化entry-chunk"><span>最小化entry chunk</span></a></h4><p>Webpack 只会在文件系统中输出已经更新的 chunk。某些配置选项(HMR, output.chunkFilename的[name]/[chunkhash]/[contenthash]，[fullhash])来说，除了对已经更新的chunk无效之外，对于entry chunk 也不会生效。 确保在生成entry chunk时，尽量减少其体积以提高性能。下面的配置为运行时代码创建了一个额外的chunk，所以它的生成代价较低:</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token operator">...</span>
	<span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token literal-property property">runtimeChunk</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="避免额外的优化步骤" tabindex="-1"><a class="header-anchor" href="#避免额外的优化步骤"><span>避免额外的优化步骤</span></a></h4><p>Webpack通过执行额外的算法任务，来优化输出结果的体积和加载性能。这些优化适用于小型代码库，但是在大型代码库中却非常耗费性能:</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">removeAvailableModules</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">removeEmptyChunks</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">splitChunks</span><span class="token operator">:</span><span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="输出结果不携带路径信息" tabindex="-1"><a class="header-anchor" href="#输出结果不携带路径信息"><span>输出结果不携带路径信息</span></a></h4><p>Webpack 会在输出的bundle 中生成路径信息。然而，在打包数千个模块的项目中，这会导致造成垃圾回收性能压力。在 options.output.pathinfo 设置中关闭：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    	<span class="token literal-property property">pathinfo</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>，
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="node-js版本8-9-10-9-11-1" tabindex="-1"><a class="header-anchor" href="#node-js版本8-9-10-9-11-1"><span>Node.js版本8.9.10-9.11.1</span></a></h4><p>Node.js v8.9.10- v9.11.1中的ES2015 Map 和 Set 实现，存在性能回退。Webpack大量地使用这些数据结构，因此这次回退也会影响编译时间。 之前和之后的Node.js版本不受影响。</p><h4 id="typescript-loader" tabindex="-1"><a class="header-anchor" href="#typescript-loader"><span>TypeScript Loader</span></a></h4><p>你可以为loader传入transpileOnly选项，以缩短使用ts-loader时的构建时间。使用此选项，会关闭类型检查。如果要再次开启类型检查，请使用ForkTsCheckerWebpackPlugin。使用此插件会将检查过程移至单独的进程，可以加快TypeScript 的类型检查和ESLint 插入的速度。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token punctuation">.</span>tsx<span class="token operator">?</span>$<span class="token operator">/</span><span class="token punctuation">,</span>
    <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;ts-loader &quot;</span> <span class="token punctuation">,</span>
    		<span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            	<span class="token literal-property property">transpileonly</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>，
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!----><!--]--><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a href="https://github.com/NightSquirrl/what-tools-blog/edit/main/src/web/webpack/webpack.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link vp-meta-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><!----></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: w1083670160@163.com">yuxiaozhuang</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link nav-link prev" href="/web/webpack/Webpack_React.html" aria-label="🧐 Webpack + React"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->🧐 Webpack + React</div></a><!----></nav><div id="comment" class="giscus-wrapper input-top" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--[--><!----><!--]--><!--]--></main><!--]--><!----></div><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-jzX7c5DY.js" defer></script>
  </body>
</html>
