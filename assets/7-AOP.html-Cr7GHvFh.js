import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as a,c as s,a as t}from"./app-jzX7c5DY.js";const e={},p=t(`<h2 id="_1-äº‹åŠ¡ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_1-äº‹åŠ¡ç®¡ç†"><span>1. äº‹åŠ¡ç®¡ç†</span></a></h2><p>äº‹åŠ¡çš„æ“ä½œä¸»è¦æœ‰ä¸‰æ­¥ï¼š</p><ol><li><p>å¼€å¯äº‹åŠ¡ï¼ˆä¸€ç»„æ“ä½œå¼€å§‹å‰ï¼Œå¼€å¯äº‹åŠ¡ï¼‰ï¼šstart transaction / begin ;</p></li><li><p>æäº¤äº‹åŠ¡ï¼ˆè¿™ç»„æ“ä½œå…¨éƒ¨æˆåŠŸåï¼Œæäº¤äº‹åŠ¡ï¼‰ï¼šcommit ;</p></li><li><p>å›æ»šäº‹åŠ¡ï¼ˆä¸­é—´ä»»ä½•ä¸€ä¸ªæ“ä½œå‡ºç°å¼‚å¸¸ï¼Œå›æ»šäº‹åŠ¡ï¼‰ï¼šrollback ;</p></li></ol><h3 id="_1-1-springäº‹åŠ¡ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_1-1-springäº‹åŠ¡ç®¡ç†"><span>1.1 <strong>Spring</strong>äº‹åŠ¡ç®¡ç†</span></a></h3><h4 id="transactionalæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#transactionalæ³¨è§£"><span><strong>Transactional</strong>æ³¨è§£</span></a></h4><blockquote><p>@Transactionalä½œç”¨ï¼šå°±æ˜¯åœ¨å½“å‰è¿™ä¸ªæ–¹æ³•æ‰§è¡Œå¼€å§‹ä¹‹å‰æ¥å¼€å¯äº‹åŠ¡ï¼Œæ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åæäº¤äº‹åŠ¡ã€‚å¦‚æœåœ¨è¿™ä¸ªæ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹å½“ä¸­å‡ºç°äº†å¼‚å¸¸ï¼Œå°±ä¼šè¿›è¡Œäº‹åŠ¡çš„å›æ»šæ“ä½œã€‚</p><p>@Transactionalæ³¨è§£ï¼šæˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨ä¸šåŠ¡å±‚å½“ä¸­æ¥æ§åˆ¶äº‹åŠ¡ï¼Œå› ä¸ºåœ¨ä¸šåŠ¡å±‚å½“ä¸­ï¼Œä¸€ä¸ªä¸šåŠ¡åŠŸèƒ½å¯èƒ½ä¼šåŒ…å«å¤šä¸ªæ•°æ®è®¿é—®çš„æ“ä½œã€‚åœ¨ä¸šåŠ¡å±‚æ¥æ§åˆ¶äº‹åŠ¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å¤šä¸ªæ•°æ®è®¿é—®æ“ä½œæ§åˆ¶åœ¨ä¸€ä¸ªäº‹åŠ¡èŒƒå›´å†…ã€‚</p></blockquote><p>@Transactionalæ³¨è§£ä¹¦å†™ä½ç½®ï¼š</p><ul><li><p>æ–¹æ³•</p><ul><li>å½“å‰æ–¹æ³•äº¤ç»™springè¿›è¡Œäº‹åŠ¡ç®¡ç†</li></ul></li><li><p>ç±»</p><ul><li>å½“å‰ç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•éƒ½äº¤ç”±springè¿›è¡Œäº‹åŠ¡ç®¡ç†</li></ul></li><li><p>æ¥å£</p><ul><li>æ¥å£ä¸‹æ‰€æœ‰çš„å®ç°ç±»å½“ä¸­æ‰€æœ‰çš„æ–¹æ³•éƒ½äº¤ç»™spring è¿›è¡Œäº‹åŠ¡ç®¡ç†</li></ul></li></ul><blockquote><p>Demo</p></blockquote><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeptServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">DeptService</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Autowired</span>
  <span class="token keyword">private</span> <span class="token class-name">DeptMapper</span> deptMapper<span class="token punctuation">;</span>
  <span class="token annotation punctuation">@Autowired</span>
  <span class="token keyword">private</span> <span class="token class-name">EmpMapper</span> empMapper<span class="token punctuation">;</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token annotation punctuation">@Transactional</span> <span class="token comment">//å½“å‰æ–¹æ³•æ·»åŠ äº†äº‹åŠ¡ç®¡ç†</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span>
    deptMapper<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ¨¡æ‹Ÿï¼šå¼‚å¸¸å‘ç”Ÿ</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span>
    empMapper<span class="token punctuation">.</span><span class="token function">deleteByDeptId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="äº‹ç‰©è¿›é˜¶" tabindex="-1"><a class="header-anchor" href="#äº‹ç‰©è¿›é˜¶"><span>äº‹ç‰©è¿›é˜¶</span></a></h4><p>å‰é¢æˆ‘ä»¬é€šè¿‡springäº‹åŠ¡ç®¡ç†æ³¨è§£@Transactionalå·²ç»æ§åˆ¶äº†ä¸šåŠ¡å±‚æ–¹æ³•çš„äº‹åŠ¡ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¦æ¥è¯¦ç»†çš„ä»‹ç»ä¸€ä¸‹@Transactionaläº‹åŠ¡ç®¡ç†æ³¨è§£çš„ä½¿ç”¨ç»†èŠ‚ã€‚æˆ‘ä»¬è¿™é‡Œä¸»è¦ä»‹ç»@Transactionalæ³¨è§£å½“ä¸­çš„ä¸¤ä¸ªå¸¸è§çš„å±æ€§ï¼š</p><ol><li><p>å¼‚å¸¸å›æ»šçš„å±æ€§ï¼šrollbackFor</p></li><li><p>äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼špropagation</p></li></ol><h5 id="rollbackfor" tabindex="-1"><a class="header-anchor" href="#rollbackfor"><span>rollbackFor</span></a></h5><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯</p><p>åªæœ‰æœ‰å‡ºç°RuntimeException(è¿è¡Œæ—¶å¼‚å¸¸)æ‰ä¼šå›æ»šäº‹åŠ¡ã€‚</p><p>é€šè¿‡é…ç½® <code>@Transactional(rollbackFor=Exception.class)</code> å®ç°æ‰€æœ‰å¼‚å¸¸çš„å›æ»š</p></blockquote><h5 id="propagation" tabindex="-1"><a class="header-anchor" href="#propagation"><span>propagation</span></a></h5><blockquote><p>å½“ A æ–¹æ³•å’Œ B æ–¹æ³•ä»–ä»¬è‡ªèº«éƒ½æœ‰è‡ªå·±çš„äº‹ç‰©çš„æ—¶å€™,å½“ A æ–¹æ³•è°ƒç”¨ Bæ–¹æ³•çš„æ—¶å€™,A æ–¹æ³•å‡ºç°å¤±è¯¯çš„å›æ»šå¦‚ä½•æ§åˆ¶è¿™ä¸¤ä¸ªäº‹ç‰©å‘¢</p></blockquote><figure><img src="https://img.picgo.net/2023/11/18/image-202311182027219288e094ed7b6dbaf97.png" alt="image-20231118202721928" tabindex="0" loading="lazy"><figcaption>image-20231118202721928</figcaption></figure><p>required:</p><p>å°†ä¸¤ä¸ªäº‹ç‰©åˆå¹¶ä¸ºä¸€ä¸ªäº‹ç‰©,å½“å…¶ä¸­çš„ä¸€ä¸ªå‘ç”Ÿäº†äº‹ç‰©çš„å›æ»šè¡Œä¸º,ä¼šåŒæ—¶è¿›è¡Œå›æ»š</p><p><code>Propagation.REQUIRES_NEW ï¼š</code>ä¸è®ºæ˜¯å¦æœ‰äº‹åŠ¡ï¼Œéƒ½åˆ›å»ºæ–°äº‹åŠ¡ ï¼Œè¿è¡Œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„äº‹</p><p>åŠ¡ä¸­ã€‚</p><blockquote><p><code> @Transactional(propagation = Propagation.REQUIRES_NEW)//äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šä¸è®ºæ˜¯å¦æœ‰äº‹åŠ¡ï¼Œéƒ½æ–°å»ºäº‹åŠ¡</code></p></blockquote><h2 id="_2-aop" tabindex="-1"><a class="header-anchor" href="#_2-aop"><span>2. AOP</span></a></h2><h3 id="_2-1-aopæ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#_2-1-aopæ¦‚è¿°"><span><strong>2.1 AOP</strong>æ¦‚è¿°</span></a></h3><p>ä»€ä¹ˆæ˜¯AOPï¼Ÿ</p><p>â€‹ AOPè‹±æ–‡å…¨ç§°ï¼šAspect Oriented Programmingï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ã€é¢å‘æ–¹é¢ç¼–ç¨‹ï¼‰ï¼Œå…¶å®è¯´ç™½äº†ï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹å°±æ˜¯é¢å‘ç‰¹å®šæ–¹æ³•ç¼–ç¨‹ã€‚</p><p>AOPçš„ä½œç”¨ï¼šåœ¨ç¨‹åºè¿è¡ŒæœŸé—´åœ¨ä¸ä¿®æ”¹æºä»£ç çš„åŸºç¡€ä¸Šå¯¹å·²æœ‰æ–¹æ³•è¿›è¡Œå¢å¼ºï¼ˆæ— ä¾µå…¥æ€§: è§£è€¦ï¼‰</p><blockquote><p>ç®€å•çš„è¯´å°±æ˜¯æ–¹æ³•çš„ä»£ç†</p></blockquote><blockquote><p>AOPçš„ä¼˜åŠ¿ï¼š</p><ol><li><p>å‡å°‘é‡å¤ä»£ç </p></li><li><p>æé«˜å¼€å‘æ•ˆç‡</p></li><li><p>ç»´æŠ¤æ–¹ä¾¿</p></li></ol></blockquote><h3 id="_2-2-aopå¿«é€Ÿå…¥é—¨å®ç°æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#_2-2-aopå¿«é€Ÿå…¥é—¨å®ç°æ­¥éª¤"><span><strong>2.2 AOP</strong>å¿«é€Ÿå…¥é—¨<strong>å®ç°æ­¥éª¤ï¼š</strong></span></a></h3><ol><li><p>å¯¼å…¥ä¾èµ–ï¼šåœ¨pom.xmlä¸­å¯¼å…¥AOPçš„ä¾èµ–</p></li><li><p>ç¼–å†™AOPç¨‹åºï¼šé’ˆå¯¹äºç‰¹å®šæ–¹æ³•æ ¹æ®ä¸šåŠ¡éœ€è¦è¿›è¡Œç¼–ç¨‹</p></li></ol><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Demo</p></blockquote><h4 id="aopç¨‹åº-timeaspect" tabindex="-1"><a class="header-anchor" href="#aopç¨‹åº-timeaspect"><span>AOPç¨‹åºï¼šTimeAspect</span></a></h4><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Aspect</span> <span class="token comment">//å½“å‰ç±»ä¸ºåˆ‡é¢ç±»</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TimeAspect</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">recordTime</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> pjp<span class="token punctuation">)</span> <span class="token keyword">throws</span>
    <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
    <span class="token comment">//è®°å½•æ–¹æ³•æ‰§è¡Œå¼€å§‹æ—¶é—´</span>
    <span class="token keyword">long</span> begin <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ‰§è¡ŒåŸå§‹æ–¹æ³•</span>
    <span class="token class-name">Object</span> result <span class="token operator">=</span> pjp<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è®°å½•æ–¹æ³•æ‰§è¡Œç»“æŸæ—¶é—´</span>
    <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è®¡ç®—æ–¹æ³•æ‰§è¡Œè€—æ—¶</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>pjp<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;æ‰§è¡Œè€—æ—¶: {}æ¯«ç§’&quot;</span><span class="token punctuation">,</span>end<span class="token operator">-</span>begin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-aopæ ¸å¿ƒæ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_2-3-aopæ ¸å¿ƒæ¦‚å¿µ"><span>2.3 AOPæ ¸å¿ƒæ¦‚å¿µ</span></a></h3><h4 id="è¿æ¥ç‚¹-joinpoint" tabindex="-1"><a class="header-anchor" href="#è¿æ¥ç‚¹-joinpoint"><span>è¿æ¥ç‚¹ï¼šJoinPointï¼Œ</span></a></h4><p>å¯ä»¥è¢«AOPæ§åˆ¶çš„æ–¹æ³•ï¼ˆæš—å«æ–¹æ³•æ‰§è¡Œæ—¶çš„ç›¸å…³ä¿¡æ¯ï¼‰</p><p>è¿æ¥ç‚¹æŒ‡çš„æ˜¯å¯ä»¥è¢«aopæ§åˆ¶çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼šå…¥é—¨ç¨‹åºå½“ä¸­æ‰€æœ‰çš„ä¸šåŠ¡æ–¹æ³•éƒ½æ˜¯å¯ä»¥è¢«aopæ§åˆ¶çš„</p><p>æ–¹æ³•ã€‚</p><h4 id="é€šçŸ¥-advice-æŒ‡å“ªäº›é‡å¤çš„é€»è¾‘-ä¹Ÿå°±æ˜¯å…±æ€§åŠŸèƒ½-æœ€ç»ˆä½“ç°ä¸ºä¸€ä¸ªæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#é€šçŸ¥-advice-æŒ‡å“ªäº›é‡å¤çš„é€»è¾‘-ä¹Ÿå°±æ˜¯å…±æ€§åŠŸèƒ½-æœ€ç»ˆä½“ç°ä¸ºä¸€ä¸ªæ–¹æ³•"><span>é€šçŸ¥ï¼šAdviceï¼ŒæŒ‡å“ªäº›é‡å¤çš„é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯å…±æ€§åŠŸèƒ½ï¼ˆæœ€ç»ˆä½“ç°ä¸ºä¸€ä¸ªæ–¹æ³•ï¼‰</span></a></h4><p>åœ¨å…¥é—¨ç¨‹åºä¸­æ˜¯éœ€è¦ç»Ÿè®¡å„ä¸ªä¸šåŠ¡æ–¹æ³•çš„æ‰§è¡Œè€—æ—¶çš„ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦åœ¨è¿™äº›ä¸šåŠ¡æ–¹æ³•è¿è¡Œå¼€å§‹ä¹‹å‰ï¼Œå…ˆè®°å½•è¿™ä¸ªæ–¹æ³•è¿è¡Œçš„å¼€å§‹æ—¶é—´ï¼Œåœ¨æ¯ä¸€ä¸ªä¸šåŠ¡æ–¹æ³•è¿è¡Œç»“æŸçš„æ—¶å€™ï¼Œå†æ¥è®°å½•è¿™ä¸ªæ–¹æ³•è¿è¡Œçš„ç»“æŸæ—¶é—´ã€‚</p><p>ä½†æ˜¯åœ¨AOPé¢å‘åˆ‡é¢ç¼–ç¨‹å½“ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦å°†è¿™éƒ¨åˆ†é‡å¤çš„ä»£ç é€»è¾‘æŠ½å–å‡ºæ¥å•ç‹¬å®šä¹‰ã€‚æŠ½å–å‡ºæ¥çš„è¿™ä¸€éƒ¨åˆ†é‡å¤çš„é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯å…±æ€§çš„åŠŸèƒ½ã€‚</p><h4 id="åˆ‡å…¥ç‚¹-pointcut-åŒ¹é…è¿æ¥ç‚¹çš„æ¡ä»¶-é€šçŸ¥ä»…ä¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œæ—¶è¢«åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#åˆ‡å…¥ç‚¹-pointcut-åŒ¹é…è¿æ¥ç‚¹çš„æ¡ä»¶-é€šçŸ¥ä»…ä¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œæ—¶è¢«åº”ç”¨"><span>**åˆ‡å…¥ç‚¹ï¼š**PointCutï¼ŒåŒ¹é…è¿æ¥ç‚¹çš„æ¡ä»¶ï¼Œé€šçŸ¥ä»…ä¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œæ—¶è¢«åº”ç”¨</span></a></h4><p>åœ¨é€šçŸ¥å½“ä¸­ï¼Œæˆ‘ä»¬æ‰€å®šä¹‰çš„å…±æ€§åŠŸèƒ½åˆ°åº•è¦åº”ç”¨åœ¨å“ªäº›æ–¹æ³•ä¸Šï¼Ÿæ­¤æ—¶å°±æ¶‰åŠåˆ°äº†åˆ‡å…¥ç‚¹pointcutæ¦‚å¿µã€‚åˆ‡å…¥ç‚¹æŒ‡çš„æ˜¯åŒ¹é…è¿æ¥ç‚¹çš„æ¡ä»¶ã€‚é€šçŸ¥ä»…ä¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œæ—¶æ‰ä¼šè¢«åº”ç”¨ã€‚åœ¨aopçš„å¼€å‘å½“ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé€šè¿‡ä¸€ä¸ªåˆ‡å…¥ç‚¹è¡¨è¾¾å¼æ¥æè¿°åˆ‡å…¥ç‚¹(åé¢ä¼šæœ‰è¯¦è§£)ã€‚</p><h4 id="åˆ‡é¢-aspect-æè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³»-é€šçŸ¥-åˆ‡å…¥ç‚¹" tabindex="-1"><a class="header-anchor" href="#åˆ‡é¢-aspect-æè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³»-é€šçŸ¥-åˆ‡å…¥ç‚¹"><span>**åˆ‡é¢ï¼š**Aspectï¼Œæè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³»ï¼ˆé€šçŸ¥+åˆ‡å…¥ç‚¹ï¼‰</span></a></h4><p>å½“é€šçŸ¥å’Œåˆ‡å…¥ç‚¹ç»“åˆåœ¨ä¸€èµ·ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªåˆ‡é¢ã€‚é€šè¿‡åˆ‡é¢å°±èƒ½å¤Ÿæè¿°å½“å‰aopç¨‹åºéœ€è¦é’ˆå¯¹äºå“ªä¸ªåŸå§‹æ–¹æ³•ï¼Œåœ¨ä»€ä¹ˆæ—¶å€™æ‰§è¡Œä»€ä¹ˆæ ·çš„æ“ä½œã€‚</p><h4 id="ç›®æ ‡å¯¹è±¡-target-é€šçŸ¥æ‰€åº”ç”¨çš„å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#ç›®æ ‡å¯¹è±¡-target-é€šçŸ¥æ‰€åº”ç”¨çš„å¯¹è±¡"><span>**ç›®æ ‡å¯¹è±¡ï¼š**Targetï¼Œé€šçŸ¥æ‰€åº”ç”¨çš„å¯¹è±¡</span></a></h4><p>ç›®æ ‡å¯¹è±¡æŒ‡çš„å°±æ˜¯é€šçŸ¥æ‰€åº”ç”¨çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºç›®æ ‡å¯¹è±¡ã€‚</p><h2 id="_3-äº‹ç‰©è¿›é˜¶" tabindex="-1"><a class="header-anchor" href="#_3-äº‹ç‰©è¿›é˜¶"><span>3. äº‹ç‰©è¿›é˜¶</span></a></h2><p>AOPçš„åŸºç¡€çŸ¥è¯†å­¦ä¹ å®Œä¹‹åï¼Œä¸‹é¢æˆ‘ä»¬å¯¹AOPå½“ä¸­çš„å„ä¸ªç»†èŠ‚è¿›è¡Œè¯¦ç»†çš„å­¦ä¹ ã€‚ä¸»è¦åˆ†ä¸º4ä¸ªéƒ¨åˆ†ï¼š</p><ol><li><p>é€šçŸ¥ç±»å‹</p></li><li><p>é€šçŸ¥é¡ºåº</p></li><li><p>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</p></li><li><p>è¿æ¥ç‚¹</p></li></ol><h3 id="_3-1-é€šçŸ¥ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_3-1-é€šçŸ¥ç±»å‹"><span>3.1 é€šçŸ¥ç±»å‹</span></a></h3><p>@Aroundï¼šç¯ç»•é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•å‰ã€åéƒ½è¢«æ‰§è¡Œ</p><p>@Beforeï¼šå‰ç½®é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•å‰è¢«æ‰§è¡Œ</p><p>@After ï¼šåç½®é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•åè¢«æ‰§è¡Œï¼Œæ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ</p><p>@AfterReturning ï¼š è¿”å›åé€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•åè¢«æ‰§è¡Œï¼Œæœ‰å¼‚å¸¸ä¸ä¼šæ‰§è¡Œ</p><p>@AfterThrowing ï¼š å¼‚å¸¸åé€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•å‘ç”Ÿå¼‚å¸¸åæ‰§è¡Œ</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Aspect</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAspect1</span> <span class="token punctuation">{</span>
  <span class="token comment">//å‰ç½®é€šçŸ¥</span>
  <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> joinPoint<span class="token punctuation">)</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;before ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//ç¯ç»•é€šçŸ¥</span>
  <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">around</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> proceedingJoinPoint<span class="token punctuation">)</span>
    <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;around before ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„åŸå§‹æ–¹æ³•æ‰§è¡Œ</span>
    <span class="token class-name">Object</span> result <span class="token operator">=</span> proceedingJoinPoint<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//åŸå§‹æ–¹æ³•å¦‚æœæ‰§è¡Œæ—¶æœ‰å¼‚å¸¸ï¼Œç¯ç»•é€šçŸ¥ä¸­çš„åç½®ä»£ç ä¸ä¼šåœ¨æ‰§è¡Œäº†</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;around after ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//åç½®é€šçŸ¥</span>
  <span class="token annotation punctuation">@After</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">after</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> joinPoint<span class="token punctuation">)</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;after ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//è¿”å›åé€šçŸ¥ï¼ˆç¨‹åºåœ¨æ­£å¸¸æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œä¼šæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span>
  <span class="token annotation punctuation">@AfterReturning</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterReturning</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> joinPoint<span class="token punctuation">)</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;afterReturning ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//å¼‚å¸¸é€šçŸ¥ï¼ˆç¨‹åºåœ¨å‡ºç°å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span>
  <span class="token annotation punctuation">@AfterThrowing</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterThrowing</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> joinPoint<span class="token punctuation">)</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;afterThrowing ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-æŠ½å–åˆ‡å…¥ç‚¹è¡¨è¾¾å¼" tabindex="-1"><a class="header-anchor" href="#_3-2-æŠ½å–åˆ‡å…¥ç‚¹è¡¨è¾¾å¼"><span>3.2 æŠ½å–åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</span></a></h3><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">//åˆ‡å…¥ç‚¹æ–¹æ³•ï¼ˆå…¬å…±çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼‰</span>
<span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">pt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// è°ƒç”¨</span>

<span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">&quot;pt()&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-é€šçŸ¥é¡ºåº" tabindex="-1"><a class="header-anchor" href="#_3-3-é€šçŸ¥é¡ºåº"><span>3.3 <strong>é€šçŸ¥é¡ºåº</strong></span></a></h3><p>é»˜è®¤æŒ‰ç…§åˆ‡é¢ç±»çš„ç±»åå­—æ¯æ’åºï¼š</p><p>â€‹ ç›®æ ‡æ–¹æ³•å‰çš„é€šçŸ¥æ–¹æ³•ï¼šå­—æ¯æ’åé å‰çš„å…ˆæ‰§è¡Œ</p><p>â€‹ ç›®æ ‡æ–¹æ³•åçš„é€šçŸ¥æ–¹æ³•ï¼šå­—æ¯æ’åé å‰çš„åæ‰§è¡Œ</p><p>å¦‚ä½•æ§åˆ¶é¡ºåº:</p><ol><li><p>ä¿®æ”¹åˆ‡é¢ç±»çš„ç±»åï¼ˆè¿™ç§æ–¹å¼éå¸¸ç¹çã€è€Œä¸”ä¸ä¾¿ç®¡ç†ï¼‰</p></li><li><p>ä½¿ç”¨Springæä¾›çš„@Orderæ³¨è§£</p></li></ol><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Aspect</span>
<span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">//åˆ‡é¢ç±»çš„æ‰§è¡Œé¡ºåºï¼ˆå‰ç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°å…ˆæ‰§è¡Œ; åç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°</span>
è¶Šåæ‰§è¡Œï¼‰
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAspect2</span> <span class="token punctuation">{</span>
    <span class="token comment">//å‰ç½®é€šçŸ¥</span>
    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;MyAspect2 -&gt; before ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//åç½®é€šçŸ¥</span>
    <span class="token annotation punctuation">@After</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;MyAspect2 -&gt; after ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>é€šçŸ¥çš„æ‰§è¡Œé¡ºåºå¤§å®¶ä¸»è¦çŸ¥é“ä¸¤ç‚¹å³å¯ï¼š</p><ol><li><p>ä¸åŒçš„åˆ‡é¢ç±»å½“ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹é€šçŸ¥çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸åˆ‡é¢ç±»çš„ç±»åå­—æ¯æ’åºæ˜¯æœ‰å…³ç³»çš„</p></li><li><p>å¯ä»¥åœ¨åˆ‡é¢ç±»ä¸Šé¢åŠ ä¸Š@Orderæ³¨è§£ï¼Œæ¥æ§åˆ¶ä¸åŒçš„åˆ‡é¢ç±»é€šçŸ¥çš„æ‰§è¡Œé¡ºåº</p></li></ol></blockquote><h3 id="_3-4-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼" tabindex="-1"><a class="header-anchor" href="#_3-4-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼"><span>3.4 <strong>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</strong></span></a></h3><h4 id="_3-4-1-execution" tabindex="-1"><a class="header-anchor" href="#_3-4-1-execution"><span>3.4.1 <strong>execution</strong></span></a></h4><p>executionä¸»è¦æ ¹æ®æ–¹æ³•çš„è¿”å›å€¼ã€åŒ…åã€ç±»åã€æ–¹æ³•åã€æ–¹æ³•å‚æ•°ç­‰ä¿¡æ¯æ¥åŒ¹é…ï¼Œè¯­æ³•ä¸ºï¼š</p><blockquote><p>execution(è®¿é—®ä¿®é¥°ç¬¦? è¿”å›å€¼ åŒ…å.ç±»å.?æ–¹æ³•å(æ–¹æ³•å‚æ•°) throws å¼‚å¸¸?)</p></blockquote><p>å…¶ä¸­å¸¦ ? çš„è¡¨ç¤ºå¯ä»¥çœç•¥çš„éƒ¨åˆ†</p><ul><li><p>è®¿é—®ä¿®é¥°ç¬¦ï¼šå¯çœç•¥ï¼ˆæ¯”å¦‚: publicã€protectedï¼‰</p></li><li><p>åŒ…å.ç±»åï¼š å¯çœç•¥</p></li><li><p>throws å¼‚å¸¸ï¼šå¯çœç•¥ï¼ˆæ³¨æ„æ˜¯æ–¹æ³•ä¸Šå£°æ˜æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä¸æ˜¯å®é™…æŠ›å‡ºçš„å¼‚å¸¸ï¼‰</p></li></ul><p>å¯ä»¥ä½¿ç”¨é€šé…ç¬¦æè¿°åˆ‡å…¥ç‚¹</p><p>* ï¼šå•ä¸ªç‹¬ç«‹çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥é€šé…ä»»æ„è¿”å›å€¼ã€åŒ…åã€ç±»åã€æ–¹æ³•åã€ä»»æ„ç±»å‹çš„ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥é€šé…åŒ…ã€ç±»ã€æ–¹æ³•åçš„ä¸€éƒ¨åˆ†</p><p>.. ï¼šå¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥é€šé…ä»»æ„å±‚çº§çš„åŒ…ï¼Œæˆ–ä»»æ„ç±»å‹ã€ä»»æ„ä¸ªæ•°çš„å‚æ•°</p><h5 id="çœç•¥æ–¹æ³•çš„ä¿®é¥°ç¬¦å·" tabindex="-1"><a class="header-anchor" href="#çœç•¥æ–¹æ³•çš„ä¿®é¥°ç¬¦å·"><span>çœç•¥æ–¹æ³•çš„ä¿®é¥°ç¬¦å·</span></a></h5><blockquote><p><code>execution(voidcom.itheima.service.impl.DeptServiceImpl.delete(java.lang.Integer))</code></p></blockquote><h5 id="ä½¿ç”¨-ä»£æ›¿è¿”å›å€¼ç±»å‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-ä»£æ›¿è¿”å›å€¼ç±»å‹"><span>ä½¿ç”¨ * ä»£æ›¿è¿”å›å€¼ç±»å‹</span></a></h5><blockquote><p><code>execution(*com.itheima.service.impl.DeptServiceImpl.delete(java.lang.Integer))</code></p></blockquote><h5 id="ä½¿ç”¨-ä»£æ›¿åŒ…å-ä¸€å±‚åŒ…ä½¿ç”¨ä¸€ä¸ª" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-ä»£æ›¿åŒ…å-ä¸€å±‚åŒ…ä½¿ç”¨ä¸€ä¸ª"><span>ä½¿ç”¨ * ä»£æ›¿åŒ…åï¼ˆä¸€å±‚åŒ…ä½¿ç”¨ä¸€ä¸ª * ï¼‰</span></a></h5><blockquote><p><code>execution(*com.itheima.*.*.DeptServiceImpl.delete(java.lang.Integer))</code></p></blockquote><h5 id="ä½¿ç”¨-çœç•¥åŒ…å" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-çœç•¥åŒ…å"><span>ä½¿ç”¨ .. çœç•¥åŒ…å</span></a></h5><blockquote><p><code>execution(* com..DeptServiceImpl.delete(java.lang.Integer))</code></p></blockquote><h5 id="ä½¿ç”¨-ä»£æ›¿ç±»å" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-ä»£æ›¿ç±»å"><span>ä½¿ç”¨ * ä»£æ›¿ç±»å</span></a></h5><blockquote><p><code>execution(* com..*.delete(java.lang.Integer)) </code></p></blockquote><h5 id="ä½¿ç”¨-ä»£æ›¿æ–¹æ³•å" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-ä»£æ›¿æ–¹æ³•å"><span>ä½¿ç”¨ * ä»£æ›¿æ–¹æ³•å</span></a></h5><blockquote><p><code>execution(* com..*.*(java.lang.Integer)) </code></p></blockquote><h5 id="ä½¿ç”¨-ä»£æ›¿å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-ä»£æ›¿å‚æ•°"><span>ä½¿ç”¨ * ä»£æ›¿å‚æ•°</span></a></h5><blockquote><p><code>execution(* com.itheima.service.impl.DeptServiceImpl.delete(*)) </code></p></blockquote><h5 id="ä½¿ç”¨-çœç•¥å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-çœç•¥å‚æ•°"><span>ä½¿ç”¨ .. çœç•¥å‚æ•°</span></a></h5><blockquote><p><code>execution(* com..*.*(..)) </code></p></blockquote><p>æ³¨æ„äº‹é¡¹ï¼š</p><p>æ ¹æ®ä¸šåŠ¡éœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨ ä¸”ï¼ˆ&amp;&amp;ï¼‰ã€æˆ–ï¼ˆ||ï¼‰ã€éï¼ˆ!ï¼‰ æ¥ç»„åˆæ¯”è¾ƒå¤æ‚çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€‚</p><blockquote><p><code>execution(* com.itheima.service.DeptService.list(..)) ||</code></p><p><code>execution(* com.itheima.service.DeptService.delete(..))</code></p></blockquote><h4 id="_3-4-2-annotation" tabindex="-1"><a class="header-anchor" href="#_3-4-2-annotation"><span>3.4.2 <strong>@annotation</strong></span></a></h4><ol><li><p>ç¼–å†™è‡ªå®šä¹‰æ³¨è§£</p></li><li><p>åœ¨ä¸šåŠ¡ç±»è¦åšä¸ºè¿æ¥ç‚¹çš„æ–¹æ³•ä¸Šæ·»åŠ è‡ªå®šä¹‰æ³¨è§£</p></li></ol><h5 id="è‡ªå®šä¹‰æ³¨è§£-mylog" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰æ³¨è§£-mylog"><span><strong>è‡ªå®šä¹‰æ³¨è§£</strong>ï¼šMyLog</span></a></h5><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">MyLog</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="ä¸šåŠ¡ç±»-deptserviceimpl" tabindex="-1"><a class="header-anchor" href="#ä¸šåŠ¡ç±»-deptserviceimpl"><span><strong>ä¸šåŠ¡ç±»</strong>ï¼šDeptServiceImpl</span></a></h5><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@MyLog</span> <span class="token comment">//è‡ªå®šä¹‰æ³¨è§£ï¼ˆè¡¨ç¤ºï¼šå½“å‰æ–¹æ³•å±äºç›®æ ‡æ–¹æ³•ï¼‰</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dept</span><span class="token punctuation">&gt;</span></span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dept</span><span class="token punctuation">&gt;</span></span> deptList <span class="token operator">=</span> deptMapper<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//æ¨¡æ‹Ÿå¼‚å¸¸</span>
  <span class="token comment">//int num = 10/0;</span>
  <span class="token keyword">return</span> deptList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="åˆ‡é¢ç±»" tabindex="-1"><a class="header-anchor" href="#åˆ‡é¢ç±»"><span><strong>åˆ‡é¢ç±»</strong></span></a></h5><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">//å‰ç½®é€šçŸ¥</span>
<span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">&quot;@annotation(com.itheima.anno.MyLog)&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-4-3-è¿æ¥ç‚¹" tabindex="-1"><a class="header-anchor" href="#_3-4-3-è¿æ¥ç‚¹"><span>3.4.3 <strong>è¿æ¥ç‚¹</strong></span></a></h4><p>åœ¨Springä¸­ç”¨JoinPointæŠ½è±¡äº†è¿æ¥ç‚¹ï¼Œç”¨å®ƒå¯ä»¥è·å¾—æ–¹æ³•æ‰§è¡Œæ—¶çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ç›®æ ‡ç±»åã€æ–¹æ³•åã€æ–¹æ³•å‚æ•°ç­‰ã€‚</p><ul><li><p>å¯¹äº@Aroundé€šçŸ¥ï¼Œè·å–è¿æ¥ç‚¹ä¿¡æ¯åªèƒ½ä½¿ç”¨ProceedingJoinPointç±»å‹</p></li><li><p>å¯¹äºå…¶ä»–å››ç§é€šçŸ¥ï¼Œè·å–è¿æ¥ç‚¹ä¿¡æ¯åªèƒ½ä½¿ç”¨JoinPointï¼Œå®ƒæ˜¯ProceedingJoinPointçš„çˆ¶ç±»å‹</p></li></ul>`,109),o=[p];function i(c,l){return a(),s("div",null,o)}const d=n(e,[["render",i],["__file","7-AOP.html.vue"]]),k=JSON.parse('{"path":"/rear-end/JavaWeb/7-AOP.html","title":"ğŸ˜¤ 7.springboot-AOP","lang":"zh-CN","frontmatter":{"title":"ğŸ˜¤ 7.springboot-AOP","tag":["SpringBoot","JavaWeb"],"recommend":7,"description":"1. äº‹åŠ¡ç®¡ç† äº‹åŠ¡çš„æ“ä½œä¸»è¦æœ‰ä¸‰æ­¥ï¼š å¼€å¯äº‹åŠ¡ï¼ˆä¸€ç»„æ“ä½œå¼€å§‹å‰ï¼Œå¼€å¯äº‹åŠ¡ï¼‰ï¼šstart transaction / begin ; æäº¤äº‹åŠ¡ï¼ˆè¿™ç»„æ“ä½œå…¨éƒ¨æˆåŠŸåï¼Œæäº¤äº‹åŠ¡ï¼‰ï¼šcommit ; å›æ»šäº‹åŠ¡ï¼ˆä¸­é—´ä»»ä½•ä¸€ä¸ªæ“ä½œå‡ºç°å¼‚å¸¸ï¼Œå›æ»šäº‹åŠ¡ï¼‰ï¼šrollback ; 1.1 Springäº‹åŠ¡ç®¡ç† Transactionalæ³¨è§£ @Transactional...","head":[["meta",{"property":"og:url","content":"https://soft-vault.com/rear-end/JavaWeb/7-AOP.html"}],["meta",{"property":"og:site_name","content":"Night.Soul"}],["meta",{"property":"og:title","content":"ğŸ˜¤ 7.springboot-AOP"}],["meta",{"property":"og:description","content":"1. äº‹åŠ¡ç®¡ç† äº‹åŠ¡çš„æ“ä½œä¸»è¦æœ‰ä¸‰æ­¥ï¼š å¼€å¯äº‹åŠ¡ï¼ˆä¸€ç»„æ“ä½œå¼€å§‹å‰ï¼Œå¼€å¯äº‹åŠ¡ï¼‰ï¼šstart transaction / begin ; æäº¤äº‹åŠ¡ï¼ˆè¿™ç»„æ“ä½œå…¨éƒ¨æˆåŠŸåï¼Œæäº¤äº‹åŠ¡ï¼‰ï¼šcommit ; å›æ»šäº‹åŠ¡ï¼ˆä¸­é—´ä»»ä½•ä¸€ä¸ªæ“ä½œå‡ºç°å¼‚å¸¸ï¼Œå›æ»šäº‹åŠ¡ï¼‰ï¼šrollback ; 1.1 Springäº‹åŠ¡ç®¡ç† Transactionalæ³¨è§£ @Transactional..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://img.picgo.net/2023/11/18/image-202311182027219288e094ed7b6dbaf97.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-02-16T14:18:39.000Z"}],["meta",{"property":"article:author","content":"Night.Soul"}],["meta",{"property":"article:tag","content":"SpringBoot"}],["meta",{"property":"article:tag","content":"JavaWeb"}],["meta",{"property":"article:modified_time","content":"2024-02-16T14:18:39.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"ğŸ˜¤ 7.springboot-AOP\\",\\"image\\":[\\"https://img.picgo.net/2023/11/18/image-202311182027219288e094ed7b6dbaf97.png\\"],\\"dateModified\\":\\"2024-02-16T14:18:39.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Night.Soul\\",\\"url\\":\\"https://github.com/NightSquirrl\\"}]}"]]},"headers":[{"level":2,"title":"1. äº‹åŠ¡ç®¡ç†","slug":"_1-äº‹åŠ¡ç®¡ç†","link":"#_1-äº‹åŠ¡ç®¡ç†","children":[{"level":3,"title":"1.1 Springäº‹åŠ¡ç®¡ç†","slug":"_1-1-springäº‹åŠ¡ç®¡ç†","link":"#_1-1-springäº‹åŠ¡ç®¡ç†","children":[]}]},{"level":2,"title":"2. AOP","slug":"_2-aop","link":"#_2-aop","children":[{"level":3,"title":"2.1 AOPæ¦‚è¿°","slug":"_2-1-aopæ¦‚è¿°","link":"#_2-1-aopæ¦‚è¿°","children":[]},{"level":3,"title":"2.2 AOPå¿«é€Ÿå…¥é—¨å®ç°æ­¥éª¤ï¼š","slug":"_2-2-aopå¿«é€Ÿå…¥é—¨å®ç°æ­¥éª¤","link":"#_2-2-aopå¿«é€Ÿå…¥é—¨å®ç°æ­¥éª¤","children":[]},{"level":3,"title":"2.3 AOPæ ¸å¿ƒæ¦‚å¿µ","slug":"_2-3-aopæ ¸å¿ƒæ¦‚å¿µ","link":"#_2-3-aopæ ¸å¿ƒæ¦‚å¿µ","children":[]}]},{"level":2,"title":"3. äº‹ç‰©è¿›é˜¶","slug":"_3-äº‹ç‰©è¿›é˜¶","link":"#_3-äº‹ç‰©è¿›é˜¶","children":[{"level":3,"title":"3.1 é€šçŸ¥ç±»å‹","slug":"_3-1-é€šçŸ¥ç±»å‹","link":"#_3-1-é€šçŸ¥ç±»å‹","children":[]},{"level":3,"title":"3.2 æŠ½å–åˆ‡å…¥ç‚¹è¡¨è¾¾å¼","slug":"_3-2-æŠ½å–åˆ‡å…¥ç‚¹è¡¨è¾¾å¼","link":"#_3-2-æŠ½å–åˆ‡å…¥ç‚¹è¡¨è¾¾å¼","children":[]},{"level":3,"title":"3.3 é€šçŸ¥é¡ºåº","slug":"_3-3-é€šçŸ¥é¡ºåº","link":"#_3-3-é€šçŸ¥é¡ºåº","children":[]},{"level":3,"title":"3.4 åˆ‡å…¥ç‚¹è¡¨è¾¾å¼","slug":"_3-4-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼","link":"#_3-4-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼","children":[]}]}],"git":{"createdTime":1700316244000,"updatedTime":1708093119000,"contributors":[{"name":"yuxiaozhuang","email":"w1083670160@163.com","commits":1},{"name":"zeroeldath","email":"zeroeldath@Mac-Pro.local","commits":1}]},"readingTime":{"minutes":8.87,"words":2661},"filePathRelative":"rear-end/JavaWeb/7-AOP.md","localizedDate":"2023å¹´11æœˆ18æ—¥","excerpt":"<h2>1. äº‹åŠ¡ç®¡ç†</h2>\\n<p>äº‹åŠ¡çš„æ“ä½œä¸»è¦æœ‰ä¸‰æ­¥ï¼š</p>\\n<ol>\\n<li>\\n<p>å¼€å¯äº‹åŠ¡ï¼ˆä¸€ç»„æ“ä½œå¼€å§‹å‰ï¼Œå¼€å¯äº‹åŠ¡ï¼‰ï¼šstart transaction / begin ;</p>\\n</li>\\n<li>\\n<p>æäº¤äº‹åŠ¡ï¼ˆè¿™ç»„æ“ä½œå…¨éƒ¨æˆåŠŸåï¼Œæäº¤äº‹åŠ¡ï¼‰ï¼šcommit ;</p>\\n</li>\\n<li>\\n<p>å›æ»šäº‹åŠ¡ï¼ˆä¸­é—´ä»»ä½•ä¸€ä¸ªæ“ä½œå‡ºç°å¼‚å¸¸ï¼Œå›æ»šäº‹åŠ¡ï¼‰ï¼šrollback ;</p>\\n</li>\\n</ol>\\n<h3>1.1 <strong>Spring</strong>äº‹åŠ¡ç®¡ç†</h3>\\n<h4><strong>Transactional</strong>æ³¨è§£</h4>\\n<blockquote>\\n<p>@Transactionalä½œç”¨ï¼šå°±æ˜¯åœ¨å½“å‰è¿™ä¸ªæ–¹æ³•æ‰§è¡Œå¼€å§‹ä¹‹å‰æ¥å¼€å¯äº‹åŠ¡ï¼Œæ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åæäº¤äº‹åŠ¡ã€‚å¦‚æœåœ¨è¿™ä¸ªæ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹å½“ä¸­å‡ºç°äº†å¼‚å¸¸ï¼Œå°±ä¼šè¿›è¡Œäº‹åŠ¡çš„å›æ»šæ“ä½œã€‚</p>\\n<p>@Transactionalæ³¨è§£ï¼šæˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨ä¸šåŠ¡å±‚å½“ä¸­æ¥æ§åˆ¶äº‹åŠ¡ï¼Œå› ä¸ºåœ¨ä¸šåŠ¡å±‚å½“ä¸­ï¼Œä¸€ä¸ªä¸šåŠ¡åŠŸèƒ½å¯èƒ½ä¼šåŒ…å«å¤šä¸ªæ•°æ®è®¿é—®çš„æ“ä½œã€‚åœ¨ä¸šåŠ¡å±‚æ¥æ§åˆ¶äº‹åŠ¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å¤šä¸ªæ•°æ®è®¿é—®æ“ä½œæ§åˆ¶åœ¨ä¸€ä¸ªäº‹åŠ¡èŒƒå›´å†…ã€‚</p>\\n</blockquote>","autoDesc":true}');export{d as comp,k as data};
